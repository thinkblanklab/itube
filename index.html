<!DOCTYPE html>
<html class="light" lang="ko">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Kids' Educational Dashboard</title>
    <link rel="icon" href="https://api.dicebear.com/9.x/avataaars/svg?seed=Felix" type="image/svg+xml">
    <script src="https://www.youtube.com/iframe_api"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />

    <!-- Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <!-- Theme Configuration -->
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#ff9800",
                        "secondary": "#4facfe",
                        "accent": "#ff6b6b",
                        "background-light": "#f4f9fc",
                        "background-dark": "#1e293b",
                        "card-light": "#ffffff",
                        "card-dark": "#334155",
                    },
                    fontFamily: {
                        "display": ["Spline Sans", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "2xl": "2rem",
                        "3xl": "2.5rem",
                        "full": "9999px"
                    },
                    boxShadow: {
                        'soft': '0 10px 40px -10px rgba(0,0,0,0.08)',
                        'glow': '0 0 20px rgba(255, 152, 0, 0.3)',
                    }
                },
            },
        }
    </script>

    <style>
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .hover-bounce {
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .hover-bounce:hover {
            transform: scale(1.05);
        }

        .pin-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #e5e7eb;
        }

        .pin-dot.filled {
            background: #111827;
        }

        .pin-key {
            padding: 14px 0;
            border-radius: 14px;
            font-weight: 800;
            background: #f1f5f9;
        }

        .pin-key:hover {
            background: #e2e8f0;
        }

        /* --- ì„¤ì • í™”ë©´ ì¹´ë“œ ë””ìì¸ --- */

        /* í•˜ì–€ìƒ‰ ì¹´ë“œ ë°•ìŠ¤ */
        .setting-card {
            background-color: #ffffff;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #f0f0f0;
            /* ë‹¤í¬ëª¨ë“œ ëŒ€ì‘ í•„ìš”ì‹œ rgbaë¡œ ë³€ê²½ */
        }

        /* ë‹¤í¬ëª¨ë“œì¼ ë•Œ ì¹´ë“œ ìƒ‰ìƒ (ì„ íƒì‚¬í•­) */
        .dark .setting-card {
            background-color: #334155;
            border-color: #475569;
        }

        .setting-title {
            font-size: 1rem;
            font-weight: 800;
            color: #333;
            margin-bottom: 12px;
        }

        .dark .setting-title {
            color: #fff;
        }

        /* --- ë²„íŠ¼í˜• ë¼ë””ì˜¤ (íšŸìˆ˜, ì‹œê°„) --- */
        .radio-group-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* ì‹¤ì œ ë¼ë””ì˜¤ ë²„íŠ¼ ìˆ¨ê¹€ */
        .radio-box input[type="radio"],
        .mode-box input[type="radio"] {
            display: none;
        }

        /* ë²„íŠ¼ ëª¨ì–‘ ì»¤ìŠ¤í…€ */
        .radio-label {
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 70px;
            height: 45px;
            padding: 0 16px;
            border-radius: 12px;
            background-color: #f1f5f9;
            /* ê¸°ë³¸ íšŒìƒ‰ */
            color: #64748b;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .dark .radio-label {
            background-color: #1e293b;
            color: #94a3b8;
        }

        /* ì„ íƒë˜ì—ˆì„ ë•Œ (ì£¼í™©ìƒ‰ í¬ì¸íŠ¸) */
        .radio-box input:checked+.radio-label {
            background-color: #FFF7ED;
            /* ì—°í•œ ì£¼í™© */
            color: #EA580C;
            /* ì§„í•œ ì£¼í™© */
            border-color: #EA580C;
            box-shadow: 0 2px 5px rgba(234, 88, 12, 0.2);
        }

        .dark .radio-box input:checked+.radio-label {
            background-color: #7c2d12;
            color: #ffedd5;
            border-color: #fb923c;
        }

        /* --- ëª¨ë“œ ì„ íƒ ë””ìì¸ (ì„¸ë¡œí˜•) --- */
        .radio-group-col {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .mode-box {
            display: block;
            cursor: pointer;
            position: relative;
        }

        .mode-content {
            display: flex;
            align-items: center;
            padding: 16px;
            border-radius: 16px;
            background-color: #f8fafc;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .dark .mode-content {
            background-color: #1e293b;
        }

        .mode-icon {
            font-size: 1.8rem;
            margin-right: 12px;
        }

        .mode-text {
            display: flex;
            flex-direction: column;
        }

        .mode-title {
            font-weight: 800;
            font-size: 0.95rem;
            color: #333;
        }

        .mode-desc {
            font-size: 0.75rem;
            color: #888;
            margin-top: 2px;
        }

        .dark .mode-title {
            color: #fff;
        }

        /* ëª¨ë“œ ì„ íƒë¨ (ì´ˆë¡ìƒ‰ í…Œë‘ë¦¬) */
        .mode-box input:checked+.mode-content {
            background-color: #F0FDF4;
            border-color: #22c55e;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.15);
        }

        .dark .mode-box input:checked+.mode-content {
            background-color: #14532d;
            border-color: #4ade80;
        }

        /* ì²´í¬ ì•„ì´ì½˜ */
        .check-icon {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2322c55e'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z'/%3E%3C/svg%3E");
            background-size: cover;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .mode-box input:checked~.check-icon {
            opacity: 1;
        }

        /* ì¹´í…Œê³ ë¦¬ íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .tab-btn {
            padding: 10px 20px;
            border-radius: 9999px;
            /* ì•Œì•½ ëª¨ì–‘ */
            font-weight: 800;
            font-size: 0.95rem;
            border: 1px solid transparent;
            transition: all 0.2s ease;
            background-color: #fff;
            color: #64748b;
            border-color: #e2e8f0;
            cursor: pointer;
        }

        .dark .tab-btn {
            background-color: #334155;
            color: #94a3b8;
            border-color: #475569;
        }

        /* ì„ íƒëœ íƒ­ ìŠ¤íƒ€ì¼ (ê²€ì •ìƒ‰/í°ìƒ‰ ë°˜ì „) */
        .tab-btn.active {
            background-color: #111827;
            /* ì§„í•œ ê²€ì • */
            color: #fff;
            border-color: #111827;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .dark .tab-btn.active {
            background-color: #f8fafc;
            color: #0f172a;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-slate-800 dark:text-slate-100 font-display antialiased transition-colors duration-300">
    <div class="min-h-screen flex flex-col">

        <!-- Header -->
        <header
            class="sticky top-0 z-50 w-full px-6 py-4 bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-md border-b border-slate-200/50 dark:border-slate-700/50">
            <div class="max-w-7xl mx-auto flex items-center justify-between">

                <div id="btnHomeLogo" class="flex items-center gap-2 group cursor-pointer select-none">

                    <img src="logo.png" alt="iTube Logo"
                        class="w-12 h-12 object-contain group-hover:scale-110 transition-transform duration-300 drop-shadow-md">

                    <div class="flex flex-col justify-center">
                        <h1
                            class="text-3xl font-black tracking-tighter text-slate-900 dark:text-white leading-none font-display">
                            iTube
                        </h1>
                        <span class="text-[11px] font-bold text-primary uppercase tracking-[0.2em] ml-0.5">
                            ì•„ì´íŠœë¸Œ
                        </span>
                    </div>
                </div>

                <div class="flex items-center gap-4">
                    <button id="btnParent"
                        class="hidden sm:flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-700 rounded-full shadow-sm border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                        <span class="material-symbols-outlined text-slate-400 text-[20px]">settings</span>
                        <span class="text-sm font-bold text-slate-600 dark:text-slate-300">ë¶€ëª¨ë‹˜ ì„¤ì •</span>
                    </button>

                    <div class="relative group cursor-pointer" onclick="openProfileModal()">
                        <div
                            class="w-12 h-12 rounded-full border-4 border-white dark:border-slate-600 shadow-md overflow-hidden bg-purple-100 relative">
                            <img id="currentProfileImg" alt="User Avatar"
                                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                                src="https://api.dicebear.com/9.x/avataaars/svg?seed=Felix" />

                            <div
                                class="absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <span class="material-symbols-outlined text-white text-sm">photo_camera</span>
                            </div>
                        </div>
                        <div
                            class="absolute -bottom-1 -right-1 w-5 h-5 bg-green-400 border-2 border-white dark:border-slate-800 rounded-full">
                        </div>
                    </div>
                </div>

            </div>
        </header>

        <!-- Home -->
        <main id="homeScreen" class="flex-grow w-full max-w-7xl mx-auto px-6 py-8 flex flex-col gap-6">

            <div class="flex flex-col gap-2">
                <h2 class="text-3xl font-black text-slate-900 dark:text-white tracking-tight">
                    ğŸ‘€ ì˜¤ëŠ˜ì˜ ê³¼í•™ ë†€ì´í„°
                </h2>
                <p class="text-sm font-bold text-slate-500 dark:text-slate-400">
                    ë³´ê³ ì‹¶ì€ ì˜ìƒì„ ê³¨ë¼ë´! ì˜ìƒ ë³´ê³  í€´ì¦ˆ ë§ì¶°ì„œ ìœ íŠœë¸Œ ë³´ëŸ¬ê°€ê¸°!
                </p>
            </div>
            <div id="categoryTabs" class="flex flex-wrap gap-2">
            </div>

            <section id="todayScience" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            </section>
        </main>

        <!-- âœ… App Modal (scriptë³´ë‹¤ ìœ„ì— ìˆì–´ì•¼ í•¨) -->
        <section id="appModal" class="hidden fixed inset-0 z-[2000]">
            <div class="absolute inset-0 bg-black/40"></div>
            <div class="relative w-full h-full flex items-center justify-center p-6">
                <div
                    class="w-full max-w-md rounded-3xl bg-white dark:bg-slate-800 border border-slate-200/60 dark:border-slate-700 shadow-xl p-6">
                    <div class="flex items-start justify-between gap-4">
                        <div>
                            <h3 id="appModalTitle" class="text-xl font-black text-slate-900 dark:text-white">ì•ˆë‚´</h3>
                            <p id="appModalBody"
                                class="mt-2 text-slate-600 dark:text-slate-200 leading-relaxed whitespace-pre-line"></p>
                        </div>
                        <button id="appModalX"
                            class="px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-700 font-bold">âœ•</button>
                    </div>

                    <div class="mt-6 flex gap-3 justify-end">
                        <button id="appModalCancel"
                            class="hidden px-5 py-3 rounded-2xl font-bold bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600">
                            ì·¨ì†Œ
                        </button>
                        <button id="appModalOk"
                            class="px-5 py-3 rounded-2xl font-black bg-primary text-white shadow-glow hover:opacity-90 transition-opacity">
                            í™•ì¸
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="promiseModal"
            class="hidden fixed inset-0 z-[2100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4">
            <div
                class="w-full max-w-md bg-white dark:bg-slate-800 rounded-3xl shadow-2xl p-6 transform transition-all scale-100">

                <div class="text-center mb-6">
                    <div class="inline-block p-3 rounded-full bg-yellow-100 text-3xl mb-2">ğŸ¤™</div>
                    <h3 class="text-xl font-black text-slate-900 dark:text-white">ì ê¹! ì•½ì†í•´ìš”</h3>

                    <p id="promiseInfoText" class="text-lg font-black text-primary mt-2 mb-1">
                    </p>
                    <p class="text-xs font-bold text-slate-400 mt-1">3ê°€ì§€ ì•½ì†ì„ ëª¨ë‘ ì²´í¬í•´ì•¼ ì¶œë°œí•  ìˆ˜ ìˆì–´ìš”!</p>
                </div>

                <div class="flex flex-col gap-3 mb-6">
                    <label
                        class="relative flex items-center p-4 rounded-xl border-2 border-slate-100 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors select-none">
                        <input type="checkbox" class="peer sr-only promise-check">
                        <div
                            class="w-6 h-6 rounded-full border-2 border-slate-300 peer-checked:bg-green-500 peer-checked:border-green-500 flex items-center justify-center transition-all mr-4">
                            <span
                                class="material-symbols-outlined text-white text-sm font-bold opacity-0 peer-checked:opacity-100">check</span>
                        </div>
                        <span class="font-bold text-slate-700 dark:text-slate-200">ğŸ“± ìˆì¸ (Shorts)ëŠ” ë³´ì§€ ì•Šê¸°!</span>
                    </label>

                    <label
                        class="relative flex items-center p-4 rounded-xl border-2 border-slate-100 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors select-none">
                        <input type="checkbox" class="peer sr-only promise-check">
                        <div
                            class="w-6 h-6 rounded-full border-2 border-slate-300 peer-checked:bg-green-500 peer-checked:border-green-500 flex items-center justify-center transition-all mr-4">
                            <span
                                class="material-symbols-outlined text-white text-sm font-bold opacity-0 peer-checked:opacity-100">check</span>
                        </div>
                        <span class="font-bold text-slate-700 dark:text-slate-200">ğŸš« ì´ìƒí•œ ì˜ìƒ í´ë¦­ ê¸ˆì§€!</span>
                    </label>

                    <label
                        class="relative flex items-center p-4 rounded-xl border-2 border-slate-100 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors select-none">
                        <input type="checkbox" class="peer sr-only promise-check">
                        <div
                            class="w-6 h-6 rounded-full border-2 border-slate-300 peer-checked:bg-green-500 peer-checked:border-green-500 flex items-center justify-center transition-all mr-4">
                            <span
                                class="material-symbols-outlined text-white text-sm font-bold opacity-0 peer-checked:opacity-100">check</span>
                        </div>
                        <span class="font-bold text-slate-700 dark:text-slate-200">â° ì•ŒëŒ ìš¸ë¦¬ë©´ ë°”ë¡œ ë„ê¸°!</span>
                    </label>
                </div>

                <div class="flex gap-3">
                    <button onclick="closePromiseModal()"
                        class="flex-1 py-4 rounded-2xl font-bold bg-slate-100 dark:bg-slate-700 text-slate-500">
                        ë‚˜ì¤‘ì—
                    </button>
                    <button id="btnPromiseStart" disabled
                        class="flex-[2] py-4 rounded-2xl font-black bg-slate-300 text-white cursor-not-allowed transition-all shadow-none">
                        ì•½ì† ì§€í‚¬ê²Œìš”! (0/3)
                    </button>
                </div>

            </div>
        </section>

        <!-- Parent PIN Modal -->
        <section id="pinModal"
            class="hidden fixed inset-0 z-[1300] bg-black/40 backdrop-blur-sm flex items-center justify-center">
            <div class="w-[320px] bg-white dark:bg-slate-800 rounded-3xl shadow-xl p-6">
                <h3 id="pinTitle" class="text-lg font-black text-center mb-4">ğŸ”’ ë¶€ëª¨ PIN ì…ë ¥</h3>

                <div class="flex justify-center gap-3 mb-4">
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                </div>

                <p id="pinError" class="hidden text-center text-sm font-bold text-red-500 mb-3">PINì´ í‹€ë ¸ì–´ìš”</p>

                <div class="grid grid-cols-3 gap-3">
                    <button class="pin-key">1</button><button class="pin-key">2</button><button
                        class="pin-key">3</button>
                    <button class="pin-key">4</button><button class="pin-key">5</button><button
                        class="pin-key">6</button>
                    <button class="pin-key">7</button><button class="pin-key">8</button><button
                        class="pin-key">9</button>
                    <button class="pin-key col-span-2">0</button>
                    <button id="pinBack">â†</button>
                </div>

                <button id="btnForgotPin" class="mt-3 w-full text-xs font-bold text-slate-500 underline">
                    ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”? (ê¸¸ê²Œ ëˆŒëŸ¬ ì´ˆê¸°í™”)
                </button>

                <button id="pinCancel"
                    class="mt-4 w-full py-2 rounded-xl font-bold text-sm bg-slate-100 dark:bg-slate-700">
                    ì·¨ì†Œ
                </button>
            </div>
        </section>

        <section id="profileModal"
            class="hidden fixed inset-0 z-[1500] bg-black/40 backdrop-blur-sm flex items-center justify-center">
            <div
                class="w-[90%] max-w-md bg-white dark:bg-slate-800 rounded-3xl shadow-2xl p-6 transform transition-all scale-100">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-black text-slate-900 dark:text-white">ë‚´ ìºë¦­í„° ê³ ë¥´ê¸°</h3>
                    <button onclick="closeProfileModal()"
                        class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                        <span class="material-symbols-outlined text-slate-500">close</span>
                    </button>
                </div>

                <div class="grid grid-cols-3 gap-4 mb-6">
                    <button onclick="changeProfile('https://api.dicebear.com/9.x/avataaars/svg?seed=Felix')"
                        class="aspect-square rounded-2xl overflow-hidden border-2 border-transparent hover:border-primary hover:scale-110 transition-all bg-blue-50">
                        <img src="https://api.dicebear.com/9.x/avataaars/svg?seed=Felix"
                            class="w-full h-full object-cover">
                    </button>
                    <button onclick="changeProfile('https://api.dicebear.com/9.x/avataaars/svg?seed=Aneka')"
                        class="aspect-square rounded-2xl overflow-hidden border-2 border-transparent hover:border-primary hover:scale-110 transition-all bg-pink-50">
                        <img src="https://api.dicebear.com/9.x/avataaars/svg?seed=Aneka"
                            class="w-full h-full object-cover">
                    </button>
                    <button onclick="changeProfile('https://api.dicebear.com/9.x/avataaars/svg?seed=Zoe')"
                        class="aspect-square rounded-2xl overflow-hidden border-2 border-transparent hover:border-primary hover:scale-110 transition-all bg-yellow-50">
                        <img src="https://api.dicebear.com/9.x/avataaars/svg?seed=Zoe"
                            class="w-full h-full object-cover">
                    </button>
                    <button onclick="changeProfile('https://api.dicebear.com/9.x/notionists/svg?seed=Leo')"
                        class="aspect-square rounded-2xl overflow-hidden border-2 border-transparent hover:border-primary hover:scale-110 transition-all bg-green-50">
                        <img src="https://api.dicebear.com/9.x/notionists/svg?seed=Leo"
                            class="w-full h-full object-cover">
                    </button>
                    <button onclick="changeProfile('https://api.dicebear.com/9.x/bottts/svg?seed=Robot')"
                        class="aspect-square rounded-2xl overflow-hidden border-2 border-transparent hover:border-primary hover:scale-110 transition-all bg-purple-50">
                        <img src="https://api.dicebear.com/9.x/bottts/svg?seed=Robot"
                            class="w-full h-full object-cover">
                    </button>
                    <button onclick="changeProfile('https://api.dicebear.com/9.x/thumbs/svg?seed=Happy')"
                        class="aspect-square rounded-2xl overflow-hidden border-2 border-transparent hover:border-primary hover:scale-110 transition-all bg-orange-50">
                        <img src="https://api.dicebear.com/9.x/thumbs/svg?seed=Happy"
                            class="w-full h-full object-cover">
                    </button>
                </div>

                <p class="text-center text-xs text-slate-400 font-bold">ë§ˆìŒì— ë“œëŠ” ì¹œêµ¬ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”!</p>
            </div>
        </section>

        <!-- Parent Setting Screen -->
        <section id="parentScreen" class="hidden fixed inset-0 z-[1100] bg-background-light dark:bg-background-dark">
            <div class="max-w-xl mx-auto px-6 py-8">
                <div class="flex items-center justify-between mb-6">
                    <button id="btnParentBack"
                        class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                        â† ëŒì•„ê°€ê¸°
                    </button>
                    <span class="text-sm font-bold text-slate-500 dark:text-slate-300">ë¶€ëª¨ë‹˜ ì „ìš©</span>
                </div>

                <h2 class="text-2xl font-black mb-6">âš™ï¸ ì˜¤ëŠ˜ì˜ ìœ íŠœë¸Œ ì„¤ì •</h2>

                <div id="todaySummary"
                    class="mb-6 rounded-2xl px-4 py-3 bg-slate-100 dark:bg-slate-700 text-sm font-bold text-slate-700 dark:text-slate-200">
                    ì˜¤ëŠ˜ ì„¤ì •: -
                </div>

                <div class="setting-card mb-6">
                    <h3 class="setting-title">ì˜¤ëŠ˜ ëª‡ ë²ˆ ë³¼ ìˆ˜ ìˆì„ê¹Œìš”?</h3>
                    <div class="radio-group-row">
                        <label class="radio-box">
                            <input type="radio" name="viewCount" value="1">
                            <span class="radio-label">1íšŒ</span>
                        </label>
                        <label class="radio-box">
                            <input type="radio" name="viewCount" value="2">
                            <span class="radio-label">2íšŒ</span>
                        </label>
                    </div>
                </div>

                <div class="setting-card mb-6">
                    <h3 class="setting-title">í•œ ë²ˆì— ë³¼ ì‹œê°„ì€?</h3>
                    <div id="timeOptions" class="radio-group-row">
                    </div>
                </div>

                <div class="setting-card mb-6">
                    <h3 class="setting-title">ì–´ë–¤ ìœ íŠœë¸Œë¥¼ ë³´ì—¬ì¤„ê¹Œìš”?</h3>
                    <div class="radio-group-col">
                        <label class="mode-box">
                            <input type="radio" name="ytMode" value="kids">
                            <div class="mode-content">
                                <div class="mode-icon">ğŸ›¡ï¸</div>
                                <div class="mode-text">
                                    <span class="mode-title">ì•ˆì „ ëª¨ë“œ (ìœ íŠœë¸Œ í‚¤ì¦ˆ)</span>
                                    <span class="mode-desc">ìœ í•´ ì˜ìƒ ì—†ëŠ” ì•ˆì „í•œ ì•±ìœ¼ë¡œ ì—°ê²°ë¼ìš”.</span>
                                </div>
                            </div>
                            <div class="check-icon"></div>
                        </label>

                        <label class="mode-box">
                            <input type="radio" name="ytMode" value="general">
                            <div class="mode-content">
                                <div class="mode-icon">ğŸ—½</div>
                                <div class="mode-text">
                                    <span class="mode-title">ììœ  ëª¨ë“œ (ì¼ë°˜ ìœ íŠœë¸Œ)</span>
                                    <span class="mode-desc">ì‹œì²­ ì „ ì•½ì†(ìˆì¸  ê¸ˆì§€ ë“±)ì„ ë³´ì—¬ì¤˜ìš”.</span>
                                </div>
                            </div>
                            <div class="check-icon"></div>
                        </label>
                    </div>
                </div>

                <button id="btnChangePin"
                    class="w-full mb-3 py-4 rounded-2xl font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600">
                    ğŸ”’ ë¶€ëª¨ PIN ë³€ê²½
                </button>

                <button id="btnSaveSetting" class="w-full py-4 rounded-2xl font-black bg-primary text-white">
                    ì˜¤ëŠ˜ ì„¤ì • ì €ì¥
                </button>
                <button onclick="localStorage.clear(); location.reload();"
                    class="w-full mt-4 py-2 text-xs text-red-400 font-bold underline hover:text-red-500">
                    âš ï¸ ì‚¬ì´íŠ¸ ì´ˆê¸°í™” (ë¬¸ì œ ìƒê²¼ì„ ë•Œë§Œ ëˆ„ë¥´ì„¸ìš”)
                </button>
            </div>
        </section>

        <!-- Player Screen -->
        <section id="playerScreen" class="hidden fixed inset-0 z-[999] bg-background-light dark:bg-background-dark">
            <div class="w-full h-full flex flex-col">
                <div
                    class="sticky top-0 z-10 px-6 py-4 bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-md border-b border-slate-200/50 dark:border-slate-700/50">
                    <div class="max-w-7xl mx-auto flex items-center justify-between gap-4">
                        <button id="btnBack"
                            class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                            <span class="material-symbols-outlined text-[20px]">arrow_back</span> Back
                        </button>

                        <div id="playerTitle"
                            class="flex-1 text-center font-black text-lg text-slate-800 dark:text-white truncate">
                            Video Title
                        </div>

                        <div class="w-[86px]"></div>
                    </div>
                </div>

                <div class="flex-grow overflow-y-auto">
                    <div class="max-w-4xl mx-auto px-6 py-6">
                        <div
                            class="rounded-3xl overflow-hidden shadow-soft border border-slate-200/50 dark:border-slate-700/50 bg-black">
                            <div class="aspect-video">
                                <div id="ytPlayer" class="w-full h-full" src="" title="YouTube player"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></div>
                            </div>
                        </div>

                        <div class="mt-5 flex flex-wrap items-center gap-3">
                            <button id="btnMission"
                                class="px-5 py-3 rounded-2xl font-black bg-primary text-white shadow-glow hover:opacity-90 transition-opacity">
                                ğŸ¯ ë¯¸ì…˜ ì‹œì‘í•˜ê¸°
                            </button>
                            <button id="btnReplay"
                                class="px-5 py-3 rounded-2xl font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                                ğŸ” ë‹¤ì‹œ ë³´ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz Screen -->
        <section id="quizScreen" class="hidden fixed inset-0 z-[1000] bg-background-light dark:bg-background-dark">
            <div class="w-full h-full flex flex-col">

                <div
                    class="sticky top-0 z-10 px-6 py-4 bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-md border-b border-slate-200/50 dark:border-slate-700/50">
                    <div class="max-w-7xl mx-auto flex items-center justify-between gap-4">
                        <button id="btnQuizBack"
                            class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                            <span class="material-symbols-outlined text-[20px]">arrow_back</span> Back
                        </button>

                        <div id="quizTitle"
                            class="flex-1 text-center font-black text-lg text-slate-800 dark:text-white truncate">Quiz
                        </div>
                        <div class="w-[86px]"></div>
                    </div>
                </div>

                <div class="flex-grow overflow-y-auto">
                    <div class="max-w-3xl mx-auto px-6 py-6">
                        <div class="flex items-center justify-between mb-4">
                            <div id="quizProgress" class="text-sm font-bold text-slate-500 dark:text-slate-300">ë¬¸ì œ 1/3
                            </div>
                            <div id="quizScore" class="text-sm font-bold text-slate-500 dark:text-slate-300">ì •ë‹µ 0/3
                            </div>
                        </div>

                        <div
                            class="bg-white dark:bg-card-dark rounded-3xl shadow-soft border border-slate-100 dark:border-slate-700 p-6">
                            <div class="flex items-start gap-3 mb-4">
                                <div
                                    class="w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black">
                                    Q</div>
                                <div class="flex-1">
                                    <h3 id="quizQuestion"
                                        class="text-xl font-black text-slate-800 dark:text-white leading-tight">
                                        ì§ˆë¬¸ì´ ì—¬ê¸°ì— ë‚˜ì˜µë‹ˆë‹¤.
                                    </h3>
                                    <p id="quizHint" class="text-sm text-slate-500 dark:text-slate-300 mt-1">
                                        íŒíŠ¸: ì˜ìƒì—ì„œ ë“¤ì€ ë‚´ìš©ì„ ë– ì˜¬ë ¤ë³´ì„¸ìš” ğŸ™‚
                                    </p>
                                </div>
                            </div>

                            <div class="grid gap-3" id="quizOptions"></div>

                            <div class="mt-4 hidden" id="quizFeedbackWrap">
                                <div class="rounded-2xl p-4 text-sm font-bold" id="quizFeedback">í”¼ë“œë°± ë©”ì‹œì§€</div>
                            </div>

                            <div class="mt-5 flex flex-wrap gap-3">
                                <button id="btnNextQuestion"
                                    class="hidden px-5 py-3 rounded-2xl font-black bg-primary text-white shadow-glow hover:opacity-90 transition-opacity">
                                    ë‹¤ìŒ ë¬¸ì œ
                                </button>

                                <button id="btnRetryQuiz"
                                    class="hidden px-5 py-3 rounded-2xl font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                                    ë‹¤ì‹œ ë„ì „
                                </button>

                                <button id="btnQuizSuccess"
                                    class="hidden px-5 py-3 rounded-2xl font-black bg-green-500 text-white hover:opacity-90 transition-opacity">
                                    âœ… í†µê³¼! (ë‹¤ìŒ ë‹¨ê³„)
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </section>

        <!-- Timer Screen -->
        <section id="timerScreen" class="hidden fixed inset-0 z-[1200] bg-background-light dark:bg-background-dark">
            <div class="w-full h-full flex flex-col">

                <div
                    class="sticky top-0 z-10 px-6 py-4 bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-md border-b border-slate-200/50 dark:border-slate-700/50">
                    <div class="max-w-7xl mx-auto flex items-center justify-between gap-4">
                        <div class="font-black text-lg text-slate-800 dark:text-white">â± íƒ€ì´ë¨¸</div>
                        <button id="btnTimerClose"
                            class="inline-flex items-center gap-2 px-4 py-2 rounded-full font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                            ë‹«ê¸°
                        </button>
                    </div>
                </div>

                <div class="flex-grow overflow-y-auto">
                    <div class="max-w-2xl mx-auto px-6 py-10">
                        <div
                            class="bg-white dark:bg-card-dark rounded-3xl shadow-soft border border-slate-100 dark:border-slate-700 p-8">
                            <p id="timerLabel" class="text-sm font-bold text-slate-500 dark:text-slate-300 mb-2">ìœ íŠœë¸Œ ì‹œì²­
                                ì¤‘â€¦</p>

                            <div id="timerText"
                                class="text-5xl md:text-6xl font-black tracking-tight text-slate-900 dark:text-white">
                                00:00
                            </div>

                            <div class="mt-6">
                                <div class="h-3 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden">
                                    <div id="timerBar" class="h-full bg-primary" style="width:0%;"></div>
                                </div>
                                <div
                                    class="mt-2 flex justify-between text-xs font-bold text-slate-500 dark:text-slate-300">
                                    <span id="timerStartText">ì‹œì‘</span>
                                    <span id="timerEndText">ì¢…ë£Œ</span>
                                </div>
                            </div>

                            <div class="mt-8 grid gap-3">
                                <button id="btnOpenYouTube"
                                    class="w-full py-4 rounded-2xl font-black bg-primary text-white shadow-glow hover:opacity-90 transition-opacity">
                                    ğŸ”— ìœ íŠœë¸Œë¡œ ì´ë™ (ìƒˆ íƒ­)
                                </button>

                                <button id="btnTimerEndNow"
                                    class="w-full py-4 rounded-2xl font-bold bg-white dark:bg-slate-700 border border-slate-100 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors">
                                    ğŸ›‘ ì§€ê¸ˆ ì¢…ë£Œ ì²˜ë¦¬(ë¶€ëª¨ìš©)
                                </button>
                            </div>

                            <p class="mt-4 text-xs text-slate-400">
                                * ì›¹í˜ì´ì§€ëŠ” ìœ íŠœë¸Œë¥¼ ê°•ì œë¡œ ì¢…ë£Œí•  ìˆ˜ ì—†ì–´ì„œ, ì‹œê°„ì´ ëë‚˜ë©´ ì•ˆë‚´í•©ë‹ˆë‹¤.
                            </p>
                        </div>

                        <div id="timerEndBox"
                            class="hidden mt-6 rounded-3xl p-6 border border-red-500/20 bg-red-500/10 text-red-700 dark:text-red-200 font-bold">
                            â° ì‹œê°„ì´ ëë‚¬ì–´ìš”! ìœ íŠœë¸Œë¥¼ ì¢…ë£Œí•˜ê³  ëŒì•„ì™€ ì£¼ì„¸ìš”.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <footer class="mt-auto py-8 text-center text-slate-400 text-sm">
            <p>Â© 2026 Watch This YouTube First. Safe content for kids.</p>
        </footer>
    </div>

    <script>
        // ===== Elements =====
        const homeScreen = document.getElementById("homeScreen");
        const btnHomeLogo = document.getElementById("btnHomeLogo");
        const todayScienceEl = document.getElementById("todayScience");

        const playerScreen = document.getElementById("playerScreen");
        const btnBack = document.getElementById("btnBack");
        const playerTitle = document.getElementById("playerTitle");
        const btnReplay = document.getElementById("btnReplay");
        const btnMission = document.getElementById("btnMission");

        const quizScreen = document.getElementById("quizScreen");
        const btnQuizBack = document.getElementById("btnQuizBack");
        const quizTitle = document.getElementById("quizTitle");
        const quizProgress = document.getElementById("quizProgress");
        const quizScore = document.getElementById("quizScore");
        const quizQuestion = document.getElementById("quizQuestion");
        const quizHint = document.getElementById("quizHint");
        const quizOptions = document.getElementById("quizOptions");
        const quizFeedbackWrap = document.getElementById("quizFeedbackWrap");
        const quizFeedback = document.getElementById("quizFeedback");
        const btnNextQuestion = document.getElementById("btnNextQuestion");
        const btnRetryQuiz = document.getElementById("btnRetryQuiz");
        const btnQuizSuccess = document.getElementById("btnQuizSuccess");

        const parentScreen = document.getElementById("parentScreen");
        const btnParentBack = document.getElementById("btnParentBack");
        const btnParent = document.getElementById("btnParent");
        const timeOptions = document.getElementById("timeOptions");
        const btnSaveSetting = document.getElementById("btnSaveSetting");
        const btnChangePin = document.getElementById("btnChangePin");

        const timerScreen = document.getElementById("timerScreen");
        const btnTimerClose = document.getElementById("btnTimerClose");
        const btnOpenYouTube = document.getElementById("btnOpenYouTube");
        const btnTimerEndNow = document.getElementById("btnTimerEndNow");
        const timerText = document.getElementById("timerText");
        const timerBar = document.getElementById("timerBar");
        const timerEndBox = document.getElementById("timerEndBox");
        const timerStartText = document.getElementById("timerStartText");
        const timerEndText = document.getElementById("timerEndText");

        // ===== ë°ì´í„°: ì´ 9ê°œ (ì‘ì„±ìë‹˜ 6ê°œ + ì¶”ì²œ 3ê°œ) =====
        const TODAY_SCIENCE = {
            subtitle: "ì˜¤ëŠ˜ì˜ ê³¼í•™ ë†€ì´í„°",
            description: "ë³´ê³ ì‹¶ì€ ì˜ìƒì„ ê³¨ë¼ë´! ì˜ìƒ ë³´ê³  í€´ì¦ˆ ë§ì¶°ì„œ ìœ íŠœë¸Œ ë³´ëŸ¬ê°€ê¸°!",
            items: [
                // --- [1ë‹¨ê³„: ë™ìš”/ì• ë‹ˆ] (ê¸°ì¡´ 3ê°œ) ---
                {
                    title: "ì•µì•µ~ ëª¨ê¸°ì˜ ë¹„ë°€",
                    channel: "ì£¼ë‹ˆí† ë‹ˆ",
                    emoji: "ğŸ¦Ÿ",
                    duration: "5ë¶„",
                    tag: "#ë™ìš” #ê³¤ì¶© #ì• ë‹ˆë©”ì´ì…˜",
                    category: "song",
                    videoId: "4TArR7UfdUs",
                    customThumb: "thumb6.jpg", // âœ… ì§ì ‘ ë§Œë“  ì´ë¯¸ì§€
                    momGuide: {
                        text: "ì—¬ë¦„ ë¶ˆì²­ê° ëª¨ê¸°! ì•”ì»·ë§Œ í”¼ë¥¼ ë¨¹ëŠ”ë‹¤ëŠ” ì‚¬ì‹¤ì„ í†µí•´ ê³¤ì¶©ì˜ ìƒíƒœë¥¼ ë°°ìš°ê³ , ìì—°ì— ëŒ€í•œ í˜¸ê¸°ì‹¬ì„ í‚¤ì›Œì¤ë‹ˆë‹¤.",
                        subject: "[ëˆ„ë¦¬ê³¼ì •] ìì—°íƒêµ¬" // ìœ ì¹˜ì› êµìœ¡ê³¼ì •
                    }
                },
                {
                    title: "ê³ ë˜ë„ ë°°ê¼½ì´ ìˆì„ê¹Œ?",
                    channel: "ê¹¨ë¹„í‚¤ì¦ˆ",
                    emoji: "ğŸ³",
                    duration: "5ë¶„",
                    tag: "#ë™ë¬¼ #í˜¸ê¸°ì‹¬ #ë§Œí™”",
                    category: "song",
                    videoId: "0VyxkOZT-Co",
                    customThumb: "thumb4.jpg", // âœ… ì§ì ‘ ë§Œë“  ì´ë¯¸ì§€
                    momGuide: {
                        text: "ê³ ë˜ë„ ë°°ê¼½ì´ ìˆì„ê¹Œ? ì•”ì»·ë§Œ í”¼ë¥¼ ë¨¹ëŠ”ë‹¤ëŠ” ì‚¬ì‹¤ì„ í†µí•´ ê³¤ì¶©ì˜ ìƒíƒœë¥¼ ë°°ìš°ê³ , ìì—°ì— ëŒ€í•œ í˜¸ê¸°ì‹¬ì„ í‚¤ì›Œì¤ë‹ˆë‹¤.",
                        subject: "[ëˆ„ë¦¬ê³¼ì •] ìì—°íƒêµ¬" // ìœ ì¹˜ì› êµìœ¡ê³¼ì •
                    }
                },
                {
                    title: "ë”ëŸ¬ìš´ ì†ì— ì„¸ê· ì´ ë°”ê¸€ë°”ê¸€!",
                    channel: "KBSí‚¤ì¦ˆ",
                    emoji: "ğŸ¦ ",
                    duration: "10ë¶„",
                    tag: "#ìƒí™œìŠµê´€ #í˜„ë¯¸ê²½ #ë§Œí™”",
                    category: "song",
                    videoId: "g7Q_SqzLCLs",
                    customThumb: "thumb2.jpg", // âœ… ì§ì ‘ ë§Œë“  ì´ë¯¸ì§€
                    momGuide: {
                        text: "ì† ì”»ê¸° ì‹«ì–´í•˜ëŠ” ì•„ì´ì—ê²Œ íš¨ê³¼ ë§Œì ! ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ” ì„¸ê· ì„ ìºë¦­í„°ë¡œ ë³´ì—¬ì£¼ì–´ ìŠ¤ìŠ¤ë¡œ ì”»ëŠ” ìŠµê´€ì„ ê¸¸ëŸ¬ì¤ë‹ˆë‹¤.",
                        subject: "[ìƒí™œìŠµê´€] ìœ„ìƒêµìœ¡" // ì—„ë§ˆë“¤ì´ ì œì¼ ì¢‹ì•„í•˜ëŠ” í¬ì¸íŠ¸
                    }
                },

                // --- [2ë‹¨ê³„: í˜¸ê¸°ì‹¬/ìƒí™©ê·¹] (ê¸°ì¡´ 3ê°œ) ---
                {
                    title: "ì ¤ë¦¬ë¥¼ ë§ì´ ë¨¹ìœ¼ë©´ ë°©ê·€ê°€ ë¿¡ë¿¡?",
                    channel: "í—¤ì´ì§€ë‹ˆ",
                    emoji: "ğŸ’¨",
                    duration: "9ë¶„",
                    tag: "#ì¸ì²´ #ì†Œí™” #ìƒí™©ê·¹",
                    category: "curiosity",
                    videoId: "ZcjCStCuJXU",
                    customThumb: "thumb1.jpg", // âœ… ì§ì ‘ ë§Œë“  ì´ë¯¸ì§€
                    momGuide: {
                        text: "ì•„ì´ë“¤ì´ ì›ƒê³  ì¦ê¸°ëŠ” ì‚¬ì´ì— 'ì†Œí™”'ì˜ ê°œë…ì„ ìµí™ë‹ˆë‹¤. ë°¥ì„ ë¨¹ìœ¼ë©´ ëª¸ì†ì—ì„œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ì´ì•¼ê¸°í•´ ë³´ì„¸ìš”.",
                        subject: "[ì¸ì²´íƒí—˜] ì†Œí™”ê¸°ê´€"
                    }
                },
                {
                    title: "ê³µë£¡ì€ ì™œ ì‚¬ë¼ì¡Œì„ê¹Œ?",
                    channel: "í˜¸ê¸°ì‹¬ ë”±ì§€",
                    emoji: "ğŸ¦–",
                    duration: "12ë¶„",
                    tag: "#ê³µë£¡ #ì§€êµ¬ì—­ì‚¬ #ì½”ë¯¹",
                    category: "curiosity",
                    videoId: "InfsfbO2Gkg",
                    customThumb: "thumb3.jpg", // âœ… ì§ì ‘ ë§Œë“  ì´ë¯¸ì§€
                    momGuide: {
                        text: "ë‹¨ìˆœí•œ ê³µë£¡ ì´ë¦„ ì™¸ìš°ê¸°ë¥¼ ë„˜ì–´, ì™œ ì‚¬ë¼ì¡Œì„ì§€ ì›ì¸ì„ ì¶”ë¡ í•´ë³´ë©° ë…¼ë¦¬ì ì¸ ì‚¬ê³ ë ¥ê³¼ ê³¼í•™ì  ìƒìƒë ¥ì„ í‚¤ì›Œì¤ë‹ˆë‹¤.",
                        subject: "[ì°½ì˜ìœµí•©] ì§€êµ¬ì˜ ì—­ì‚¬"
                    }
                },
                {
                    title: "ë§Œì•½ ì§€êµ¬ê°€ 1ì´ˆë§ˆë‹¤ ì»¤ì§„ë‹¤ë©´?",
                    channel: "ê³ êµ¬ë§ˆë¨¸ë¦¬",
                    emoji: "ğŸŒ",
                    duration: "7ë¶„",
                    tag: "#ìš°ì£¼ #ìƒìƒë ¥ #ê³¼í•™ì§€ì‹",
                    category: "curiosity",
                    videoId: "SUV_T-SW-uo",
                    customThumb: "thumb5.jpg", // âœ… ì§ì ‘ ë§Œë“  ì´ë¯¸ì§€
                    momGuide: {
                        text: "ì§€êµ¬ê°€ ì»¤ì§€ë©´ ì¤‘ë ¥ì€ ì–´ë–»ê²Œ ë ê¹Œìš”? ê¸°ë°œí•œ ìƒìƒë ¥ì„ ë°”íƒ•ìœ¼ë¡œ ì§€êµ¬ì˜ í¬ê¸°, ì¤‘ë ¥, ëŒ€ê¸°ì˜ ê´€ê³„ë¥¼ ì‰½ê³  ì¬ë¯¸ìˆê²Œ ì´í•´í•©ë‹ˆë‹¤.",
                        subject: "[3-1 ê³¼í•™] ì§€êµ¬ì˜ ëª¨ìŠµ"
                    }
                },

                // --- [3ë‹¨ê³„: ì° ê³¼í•™ íƒêµ¬] (ìƒˆë¡œ ì¶”ê°€ëœ 3ê°œ + ì—„ë§ˆ ê°€ì´ë“œ) ---
                {
                    title: "ë¹„ê°€ ì˜¤ë©´ ê°œë¯¸ì§‘ì€ ë¬¼ì— ì ê¸¸ê¹Œ?",
                    channel: "ì‚¬ë¬¼ê¶ì´",
                    emoji: "ğŸœ",
                    duration: "4ë¶„",
                    tag: "#ê³¤ì¶© #ê±´ì¶• #ìì—°ê´€ì°°",
                    category: "science_real", // ìƒˆë¡œìš´ ì¹´í…Œê³ ë¦¬ (ë˜ëŠ” curiosityì— í¬í•¨ ê°€ëŠ¥)
                    videoId: "_XulUbBra5M",
                    customThumb: "thumb7.jpg",
                    // ğŸ‘©â€ğŸ« ì—„ë§ˆë¥¼ ìœ„í•œ ê°€ì´ë“œ ì¶”ê°€
                    momGuide: {
                        text: "ë¹„ê°€ ì™€ë„ ë¬´ë„ˆì§€ì§€ ì•ŠëŠ” ê°œë¯¸ì§‘ì˜ ë¹„ë°€! ìì—° ì† ê±´ì¶• ì›ë¦¬ë¥¼ ë°°ìš°ë©° ê´€ì°°ë ¥ì„ í‚¤ì›Œì¤ë‹ˆë‹¤.",
                        subject: "[3-2 ê³¼í•™] ë™ë¬¼ì˜ ìƒí™œ"
                    }
                },
                {
                    title: "ë°”ë‚˜ë‚˜ëŠ” ì”¨ê°€ ì—†ëŠ”ë° ì–´ë–»ê²Œ í‚¤ìš¸ê¹Œ?",
                    channel: "ê³¼í•™ë“œë¦¼",
                    emoji: "ğŸŒ",
                    duration: "5ë¶„",
                    tag: "#ì‹ë¬¼ #ê³¼ì¼ #ìœ ì „ê°€ìœ„",
                    category: "science_real",
                    videoId: "oA2PaUmv4ho",
                    customThumb: "thumb8.jpg",
                    momGuide: {
                        text: "ë§¤ì¼ ë¨¹ëŠ” ë°”ë‚˜ë‚˜ì— ì”¨ê°€ ì—†ëŠ” ì´ìœ ! ì”¨ì•— ëŒ€ì‹  ì¤„ê¸°ë¡œ ë²ˆì‹í•˜ëŠ” ì›ë¦¬ì™€ 'ìœ ì „ì  ë‹¤ì–‘ì„±'ì˜ ì¤‘ìš”ì„±ì„ ë°°ì›ë‹ˆë‹¤.",
                        subject: "[5-1 ê³¼í•™] ì‹ë¬¼ì˜ êµ¬ì¡°ì™€ ê¸°ëŠ¥"
                    }
                },
                {
                    title: "í­ê·„ì€ ì–´ë–»ê²Œ ë™ìƒì— ê±¸ë¦¬ì§€ ì•Šì„ê¹Œ?",
                    channel: "ì€ê·¼í•œ ì¡ë‹¤í•œ ì§€ì‹",
                    emoji: "ğŸ§",
                    duration: "5ë¶„",
                    tag: "#ë™ë¬¼ #ì ì‘ #ë‚¨ê·¹",
                    category: "science_real",
                    videoId: "eA89rfDWGMs",
                    customThumb: "thumb91.jpg",
                    // ğŸ‘©â€ğŸ« ì—„ë§ˆë¥¼ ìœ„í•œ ê°€ì´ë“œ ì¶”ê°€
                    momGuide: {
                        text: "ì¶”ìš´ ë‚¨ê·¹ì—ì„œë„ ì–¼ì§€ ì•ŠëŠ” í­ê·„ì˜ ì‹ ì²´ ë¹„ë°€! í™˜ê²½ì— ì ì‘í•˜ëŠ” ë™ë¬¼ì˜ ì§€í˜œë¥¼ ë°°ì›ë‹ˆë‹¤.",
                        subject: "[3-2 ê³¼í•™] ë™ë¬¼ì˜ ìƒí™œ"
                    }
                }
            ]
        };

        // â˜… ì¹´í…Œê³ ë¦¬ ëª©ë¡ (ì—¬ê¸°ê°€ í•µì‹¬!)
        // 9ì‚´ ì•„ì´ì—ê²Œ "ìœ ì•„ìš©"ì´ë¼ê³  ë§í•˜ëŠ” ëŒ€ì‹  "ë™ìš”/ì• ë‹ˆ"ë¼ê³  í‘œí˜„í•´ì„œ ìì¡´ì‹¬ì„ ì§€ì¼œì¤ë‹ˆë‹¤.
        const CATEGORIES = [
            { id: 'all', name: 'ì „ì²´ë³´ê¸°' },
            { id: 'song', name: 'ğŸµ ë™ìš”Â·ì• ë‹ˆ' },      // 6~7ì„¸ ì¶”ì²œ
            { id: 'curiosity', name: 'ğŸ§ª í˜¸ê¸°ì‹¬ í•´ê²°' },  // 7~9ì„¸ ì¶”ì²œ
            { id: 'science_real', name: 'ğŸ”¬ ìƒìƒ ê³¼í•™ íƒí—˜' }     // 9~10ì„¸ ì¶”ì²œ
        ];

        let currentCategory = 'all';

        // --- (ì•„ë˜ ë Œë”ë§ í•¨ìˆ˜ë“¤ì€ ê·¸ëŒ€ë¡œ ë‘ì…”ë„ ë©ë‹ˆë‹¤) ---
        function renderCategoryTabs() {
            const tabContainer = document.getElementById("categoryTabs");
            tabContainer.innerHTML = CATEGORIES.map(cat => `
        <button 
            class="tab-btn ${currentCategory === cat.id ? 'active' : ''}" 
            onclick="setCategory('${cat.id}')">
            ${cat.name}
        </button>
    `).join("");
        }

        function setCategory(catId) {
            currentCategory = catId;
            renderCategoryTabs();
            renderTodayScience();
        }

        function renderTodayScience() {
            if (!todayScienceEl) return;

            // 1. í˜„ì¬ ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” ì˜ìƒë§Œ ê³¨ë¼ë‚´ê¸°
            const filteredItems = (currentCategory === 'all')
                ? TODAY_SCIENCE.items
                : TODAY_SCIENCE.items.filter(item => item.category === currentCategory);

            // 2. ì˜ìƒì´ ì—†ì„ ë•Œ ë©”ì‹œì§€
            if (filteredItems.length === 0) {
                todayScienceEl.innerHTML = `<div class="col-span-full text-center py-10 text-slate-400 font-bold">ì´ ì¹´í…Œê³ ë¦¬ì—” ì•„ì§ ì˜ìƒì´ ì—†ì–´ìš”!</div>`;
                return;
            }

            // 3. HTML ë§Œë“¤ê¸°
            todayScienceEl.innerHTML = filteredItems.map(item => {
                const thumbSrc = item.customThumb
                    ? item.customThumb
                    : `https://img.youtube.com/vi/${item.videoId}/maxresdefault.jpg`;

                // (1) ì—„ë§ˆ ê°€ì´ë“œ (ì•„ë˜ìª½ ë…¸ë€ ë°•ìŠ¤)
                let guideHtml = '';
                if (item.momGuide) {
                    guideHtml = `
                        <div class="hidden group-hover:block absolute bottom-0 left-0 right-0 p-4 bg-[#fff8e1] border-t-2 border-[#ffd54f] animate-fade-in-up z-20 text-left">
                            <div style="font-weight: bold; color: #f57f17; margin-bottom: 4px; font-size: 14px;">
                                ğŸ‘©â€ğŸ« ì—„ë§ˆ ë³´ì„¸ìš”! <span style="background:#f57f17; color:white; padding:2px 6px; border-radius:4px; font-size:11px; margin-left:5px;">${item.momGuide.subject}</span>
                            </div>
                            <div style="color: #555; line-height: 1.3; font-size: 12px;">${item.momGuide.text}</div>
                        </div>
                    `;
                }

                // (2) ì¬ìƒ ì•„ì´ì½˜ (ê°€ìš´ë° í•˜ì–€ ë²„íŠ¼)
                const playIconHtml = `
                    <div class="absolute inset-y-0 right-6 flex items-center opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                        <div class="w-9 h-9 bg-black/50 rounded-full flex items-center justify-center backdrop-blur-sm border-2 border-white/80 shadow-lg transform group-hover:scale-110 transition-transform">
                            <span class="material-symbols-outlined text-white text-[24px] ml-0.5">play_arrow</span>
                        </div>
                    </div>
                `;

                return `
                <button class="group relative aspect-video w-full rounded-3xl overflow-hidden shadow-soft hover:shadow-glow hover:scale-[1.03] transition-all duration-300 ring-4 ring-white dark:ring-slate-700 bg-slate-900"
                  data-video-id="${item.videoId}" data-title="${item.title}">
                  
                  <img src="${thumbSrc}" 
                       class="absolute inset-0 w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700 opacity-90" 
                       alt="${item.title}"
                       onerror="this.src='https://img.youtube.com/vi/${item.videoId}/mqdefault.jpg'"
                  >
                  
                  <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-60 group-hover:opacity-80 transition-opacity"></div>

                  <div class="absolute inset-0 p-5 flex flex-col justify-end text-left pb-8 group-hover:pb-24 transition-all duration-300 z-0">
                    
                    <div class="flex flex-wrap items-center gap-2 mb-2 translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300">
                       ${item.tag.split(' ').map(t =>
                    `<span class="px-2 py-1 rounded-md bg-white/20 backdrop-blur-md text-white text-[10px] font-bold border border-white/10">
                            ${t}
                          </span>`
                ).join('')}
                       <span class="text-[10px] font-bold text-primary drop-shadow-md ml-auto bg-black/50 px-2 py-1 rounded-full">
                         â° ${item.duration}
                       </span>
                    </div>

                    <div class="mb-1">
                        <span class="inline-block px-2 py-0.5 rounded text-[11px] font-black bg-primary text-white shadow-sm">
                            ${item.channel || 'YouTube'}
                        </span>
                    </div>

                    <h3 class="text-lg md:text-xl font-black text-white leading-tight drop-shadow-lg transition-all duration-300 line-clamp-2
           group-hover:text-white group-hover:drop-shadow-[0_0_10px_rgba(251,146,60,1)]">
  ${item.title}
</h3>
                  </div>
                  
                  ${playIconHtml}
                  ${guideHtml}
                  
                </button>
                `;
            }).join("");
        }

        // ì´ˆê¸°í™” ì‹¤í–‰ (í•¨ìˆ˜ ë°–ì—ì„œ ë”± í•œ ë²ˆë§Œ!)
        renderCategoryTabs();
        renderTodayScience();

        // ===== App Modal (ê³µìš©) =====
        const appModal = document.getElementById("appModal");
        const appModalTitle = document.getElementById("appModalTitle");
        const appModalBody = document.getElementById("appModalBody");
        const appModalOk = document.getElementById("appModalOk");
        const appModalCancel = document.getElementById("appModalCancel");
        const appModalX = document.getElementById("appModalX");

        let appModalResolve = null;

        function showAppModal({ title = "ì•ˆë‚´", message = "", okText = "í™•ì¸", cancelText = null } = {}) {
            appModalTitle.textContent = title;
            appModalBody.textContent = message;
            appModalOk.textContent = okText;

            if (cancelText) {
                appModalCancel.textContent = cancelText;
                appModalCancel.classList.remove("hidden");
            } else {
                appModalCancel.classList.add("hidden");
            }

            appModal.classList.remove("hidden");
            return new Promise(resolve => { appModalResolve = resolve; });
        }

        function closeAppModal(result) {
            appModal.classList.add("hidden");
            if (appModalResolve) { appModalResolve(result); appModalResolve = null; }
        }

        appModalOk.addEventListener("click", () => closeAppModal(true));
        appModalCancel.addEventListener("click", () => closeAppModal(false));
        appModalX.addEventListener("click", () => closeAppModal(false));

        const btnForgotPin = document.getElementById("btnForgotPin");

        let forgotHoldTimer = null;

        btnForgotPin.addEventListener("pointerdown", () => {
            forgotHoldTimer = setTimeout(async () => {
                const ok = await showAppModal({
                    title: "PIN ì´ˆê¸°í™”",
                    message: "ë¶€ëª¨ PINì„ ê¸°ë³¸ê°’(1111)ìœ¼ë¡œ ì´ˆê¸°í™”í• ê¹Œìš”?",
                    okText: "ì´ˆê¸°í™”",
                    cancelText: "ì·¨ì†Œ"
                });

                if (!ok) return;

                // PIN í‚¤ ì´ë¦„ì€ ë„¤ ì½”ë“œì— ë§ì¶°ì•¼ í•¨ (ì˜ˆ: PIN_KEYê°€ ìˆìœ¼ë©´ ê·¸ê±¸ ì‚¬ìš©)
                localStorage.setItem(PIN_KEY, "1111");

                await showAppModal({
                    title: "ì´ˆê¸°í™” ì™„ë£Œ",
                    message: "PINì´ 1111ë¡œ ì´ˆê¸°í™”ëì–´ìš”. ë“¤ì–´ê°„ ë’¤ ê¼­ ë³€ê²½í•´ ì£¼ì„¸ìš”.",
                    okText: "í™•ì¸"
                });

                // ì…ë ¥ ìƒíƒœë„ ì´ˆê¸°í™”(ì„ íƒ)
                pinInput = "";
                updatePinDots();
            }, 1200); // 1.2ì´ˆ ê¸¸ê²Œ ëˆ„ë¥´ê¸°
        });

        ["pointerup", "pointerleave", "pointercancel"].forEach(evt => {
            btnForgotPin.addEventListener(evt, () => {
                if (forgotHoldTimer) clearTimeout(forgotHoldTimer);
                forgotHoldTimer = null;
            });
        });


        // ì´ë²¤íŠ¸ ìœ„ì„(í•œ ë²ˆë§Œ)
        todayScienceEl.addEventListener("click", (e) => {
            const btn = e.target.closest("[data-video-id]");
            if (!btn) return;

            const videoId = btn.getAttribute("data-video-id");
            const title = btn.getAttribute("data-title") || "Video";
            if (!videoId) return;

            openPlayer(videoId, title);
        });

        // ===== Player =====
        let currentVideoId = "";
        let currentTitle = "";

        let ytPlayer = null;
        let canStartMission = false;

        function onYouTubeIframeAPIReady() {
            ytPlayer = new YT.Player("ytPlayer", {
                videoId: "",
                playerVars: {
                    rel: 0,            // ê´€ë ¨ ì˜ìƒ ì•ˆ ëœ¨ê²Œ (ìµœì†Œí™”)
                    modestbranding: 1, // ìœ íŠœë¸Œ ë¡œê³  ì‘ê²Œ
                    playsinline: 1,    // ëª¨ë°”ì¼ì—ì„œ ì „ì²´í™”ë©´ ëŒ€ì‹  ê·¸ëƒ¥ ì¬ìƒ
                    hl: 'ko',          // í”Œë ˆì´ì–´ ë©”ë‰´ ì–¸ì–´ëŠ” í•œêµ­ì–´ë¡œ ìœ ì§€
                    // cc_load_policy: 1, // âŒ ì‚­ì œë¨ (ìë§‰ ìë™ ì¼œê¸° ë”)
                    // cc_lang_pref: 'ko' // âŒ ì‚­ì œë¨ (ìë§‰ ì–¸ì–´ ì„¤ì • ë”)
                },
                events: {
                    onStateChange: onPlayerStateChange
                }
            });
        }

        function onPlayerStateChange(event) {
            // ì˜ìƒ ëë‚¨(ENDED = 0)
            if (event.data === YT.PlayerState.ENDED) {
                canStartMission = true;
                btnMission.disabled = false;
                btnMission.classList.remove("opacity-50", "cursor-not-allowed");
            }
        }

        function openPlayer(videoId, title) {
            currentVideoId = videoId;
            currentTitle = title || "Video";

            playerTitle.textContent = currentTitle;

            // âœ… ë¯¸ì…˜ ì ê¸ˆ ì´ˆê¸°í™”
            canStartMission = false;
            btnMission.disabled = true;
            btnMission.classList.add("opacity-50", "cursor-not-allowed");

            // âœ… ìœ íŠœë¸Œ APIë¡œ ë¡œë“œ
            if (ytPlayer && ytPlayer.loadVideoById) {
                ytPlayer.loadVideoById(videoId);
            }

            homeScreen.classList.add("hidden");
            playerScreen.classList.remove("hidden");
            document.body.classList.add("overflow-hidden");
        }


        function closePlayer() {
            playerScreen.classList.add("hidden");
            homeScreen.classList.remove("hidden");
            document.body.classList.remove("overflow-hidden");
            if (ytPlayer && ytPlayer.stopVideo) ytPlayer.stopVideo();
            currentVideoId = "";
            currentTitle = "";
        }

        btnBack.addEventListener("click", closePlayer);

        btnReplay.addEventListener("click", () => {
            if (!currentVideoId) return;
            if (ytPlayer && ytPlayer.loadVideoById) {
                ytPlayer.loadVideoById(currentVideoId);
            }
        });


        // ===== QUIZ BANK (ì˜ìƒë³„ ë§ì¶¤ í€´ì¦ˆ - ì „ì²´ 9ê°œ ì™„ë¹„) =====
        const QUIZ_BANK = {
            // 1. ëª¨ê¸° (ì£¼ë‹ˆí† ë‹ˆ) - ID: 4TArR7UfdUs
            "4TArR7UfdUs": [
                { q: "ëª¨ê¸°ëŠ” ì™œ ì‚¬ëŒì„ ë¬¼ê¹Œìš”?", hint: "ì•”ì»· ëª¨ê¸°ê°€ ì•Œì„ ë‚³ìœ¼ë ¤ë©´ ì˜ì–‘ë¶„ì´ í•„ìš”í•´ìš”.", options: ["ì‚¬ëŒì´ ì¢‹ì•„ì„œ", "ì•Œì„ ë‚³ê¸° ìœ„í•œ ì˜ì–‘ë¶„(í”¼) ë•Œë¬¸ì—", "ì‹¬ì‹¬í•´ì„œ", "ì ì„ ê¹¨ìš°ë ¤ê³ "], answerIndex: 1 },
                { q: "ëª¨ê¸°ì— ë¬¼ë¦¬ë©´ ì™œ ê°€ë ¤ìš¸ê¹Œìš”?", hint: "ëª¨ê¸°ê°€ í”¼ë¥¼ ë¨¹ì„ ë•Œ ë‚¨ê¸°ëŠ” ì¹¨ ë•Œë¬¸ì´ì—ìš”.", options: ["ëª¨ê¸° ì¹¨ ì•Œë ˆë¥´ê¸° ë•Œë¬¸ì—", "í‚¤ê°€ í¬ë ¤ê³ ", "ë°°ê°€ ë¶ˆëŸ¬ì„œ", "ê¸°ë¶„ì´ ì¢‹ì•„ì„œ"], answerIndex: 0 },
                { q: "ëª¨ê¸°ë¥¼ í”¼í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?", hint: "ì ì˜ ë•Œ ì¹¨ëŒ€ ìœ„ì— ì´ê±¸ ì¹˜ë©´ ì¢‹ì•„ìš”.", options: ["ë¬¼ì„ ë°›ì•„ë†“ê¸°", "ëª¨ê¸°ì¥ ì‚¬ìš©í•˜ê¸°", "ì°½ë¬¸ í™œì§ ì—´ê¸°", "ë¶ˆ ë„ê³  ìˆ¨ê¸°"], answerIndex: 1 }
            ],
            // 2. ê³ ë˜ ë°°ê¼½ (ê¹¨ë¹„í‚¤ì¦ˆ) - ID: 0VyxkOZT-Co
            "0VyxkOZT-Co": [
                { q: "ê³ ë˜ì—ê²Œ ë°°ê¼½ì´ ìˆëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?", hint: "ì—„ë§ˆ ë±ƒì†ì— ìˆì„ ë•Œ íƒ¯ì¤„ì´ ìˆì—ˆê¸° ë•Œë¬¸ì´ì—ìš”.", options: ["ìˆ¨ì„ ì‰¬ë ¤ê³ ", "ì—„ë§ˆì™€ ì—°ê²°ë˜ì—ˆë˜ í”ì ì´ë¼ì„œ", "ë°¥ì„ ë¨¹ìœ¼ë ¤ê³ ", "ì¥ë‚œì¹˜ë ¤ê³ "], answerIndex: 1 },
                { q: "ê³ ë˜ëŠ” ì•Œì„ ë‚³ì„ê¹Œìš”, ìƒˆë¼ë¥¼ ë‚³ì„ê¹Œìš”?", hint: "ê³ ë˜ëŠ” í¬ìœ ë¥˜ë¼ì„œ ìš°ë¦¬ì²˜ëŸ¼...", options: ["ì•Œì„ ë‚³ëŠ”ë‹¤", "ìƒˆë¼ë¥¼ ë‚³ëŠ”ë‹¤", "ë°˜ë°˜ ì„ì–´ì„œ ë‚³ëŠ”ë‹¤", "ë‚˜ë¬´ì—ì„œ ì—´ë¦°ë‹¤"], answerIndex: 1 },
                { q: "ê³ ë˜ì™€ ê°™ì€ ë™ë¬¼(í¬ìœ ë¥˜)ì´ ì•„ë‹Œ ê²ƒì€?", hint: "ì´ ë™ë¬¼ì€ ì•Œì„ ë‚³ì•„ìš”.", options: ["ì‚¬ëŒ", "ê°•ì•„ì§€", "ê³ ì–‘ì´", "ë¶•ì–´(ë¬¼ê³ ê¸°)"], answerIndex: 3 }
            ],
            // 3. ì„¸ê·  (KBS í‚¤ì¦ˆ) - ID: g7Q_SqzLCLs
            "g7Q_SqzLCLs": [
                { q: "ì†ì„ ì”»ì§€ ì•Šìœ¼ë©´ ì†ì— ë¬´ì—‡ì´ ë§ì•„ì§ˆê¹Œìš”?", hint: "ëˆˆì— ì•ˆ ë³´ì´ëŠ” ì‘ì€ ê´´ë¬¼ë“¤!", options: ["ì‚¬íƒ•", "ì„¸ê· (ë°”ì´ëŸ¬ìŠ¤)", "ë¬¼", "ê³µê¸°"], answerIndex: 1 },
                { q: "ì–¸ì œ ì†ì„ ì”»ëŠ” ê²ƒì´ ê°€ì¥ ì¤‘ìš”í• ê¹Œìš”?", hint: "ë”ëŸ¬ìš´ ê±¸ ë§Œì§€ê³  ë‚˜ì„œëŠ” ê¼­ ì”»ì–´ì•¼ í•´ìš”.", options: ["ë†€ê³  ë‚˜ì„œ", "ë°¥ ë¨¹ê¸° ì „", "í™”ì¥ì‹¤ ë‹¤ë…€ì˜¨ í›„", "ëª¨ë‘ ë§ë‹¤"], answerIndex: 3 },
                { q: "ì„¸ê· ì„ ì—†ì• ë ¤ë©´ ë¬´ì—‡ìœ¼ë¡œ ì”»ì–´ì•¼ í• ê¹Œìš”?", hint: "ë¬¼ë¡œë§Œ ì”»ìœ¼ë©´ ì•ˆ ë¼ìš”.", options: ["ë¹„ëˆ„ì™€ ë¬¼", "í™", "ë°”ëŒ", "ìˆ˜ê±´ìœ¼ë¡œë§Œ ë‹¦ê¸°"], answerIndex: 0 }
            ],

            // 4. ë°©ê·€ (í—¤ì´ì§€ë‹ˆ) - ID: ZcjCStCuJXU
            "ZcjCStCuJXU": [
                { q: "ì ¤ë¦¬ë¥¼ ë„ˆë¬´ ë§ì´ ë¨¹ìœ¼ë©´ ì™œ ë°©ê·€ê°€ ë‚˜ì˜¬ê¹Œìš”?", hint: "ë±ƒì†ì—ì„œ ì†Œí™”ë˜ë©´ì„œ ê°€ìŠ¤ê°€ ìƒê²¨ìš”.", options: ["ëª¸ì´ ì ¤ë¦¬ë¥¼ ì‹«ì–´í•´ì„œ", "ì†Œí™”ë˜ë©´ì„œ ê°€ìŠ¤ê°€ ìƒê²¨ì„œ", "ì ¤ë¦¬ê°€ ê³µê¸°ë¼ì„œ", "ë°©ê·€ê°€ ì¬ë°Œì–´ì„œ"], answerIndex: 1 },
                { q: "ë°©ê·€ëŠ” ìš°ë¦¬ ëª¸ì—ì„œ ë‚˜ìœ ê²ƒì¼ê¹Œìš”?", hint: "ê±´ê°•í•˜ë‹¤ëŠ” ì‹ í˜¸ì¼ ìˆ˜ë„ ìˆì–´ìš”.", options: ["ë¬´ì¡°ê±´ ë‚˜ì˜ë‹¤", "ìì—°ìŠ¤ëŸ¬ìš´ í˜„ìƒì´ë‹¤", "ë³‘ì— ê±¸ë¦° ê²ƒì´ë‹¤", "ì°¸ì•„ì•¼ í•œë‹¤"], answerIndex: 1 },
                { q: "ê±´ê°•í•œ ì¥ì„ ìœ„í•´ ì ¤ë¦¬ëŠ” ì–´ë–»ê²Œ ë¨¹ì„ê¹Œìš”?", hint: "í•œêº¼ë²ˆì— ë§ì´ ë¨¹ìœ¼ë©´ ë°°ê°€ ì•„íŒŒìš”.", options: ["í•œ ë²ˆì— ë§ì´ ë¨¹ê¸°", "ë°¥ ëŒ€ì‹  ë¨¹ê¸°", "ì¡°ê¸ˆì”© ë‚˜ëˆ  ë¨¹ê¸°", "í•˜ë£¨ ì¢…ì¼ ë¨¹ê¸°"], answerIndex: 2 }
            ],
            // 5. ê³µë£¡ (í˜¸ê¸°ì‹¬ ë”±ì§€) - ID: InfsfbO2Gkg
            "InfsfbO2Gkg": [
                { q: "ê³µë£¡ì´ ì‚´ë˜ ì‹œëŒ€ëŠ” ì–¸ì œì¼ê¹Œìš”?", hint: "ìš°ë¦¬ê°€ íƒœì–´ë‚˜ê¸° ì•„ì£¼ì•„ì£¼ ì „ì´ì•¼.", options: ["ì§€ê¸ˆ", "ì•„ì£¼ ë¨¼ ì˜›ë‚ (ì¤‘ìƒëŒ€)", "ë¯¸ë˜", "ì¡°ì„ ì‹œëŒ€"], answerIndex: 1 },
                { q: "ê³µë£¡ì´ ì‚¬ë¼ì§„ ì´ìœ ë¡œ ê°€ì¥ ìœ ëª…í•œ ê²ƒì€?", hint: "ìš°ì£¼ì—ì„œ ì¿µ! í•˜ê³  ë–¨ì–´ì¡ŒëŒ€ìš”.", options: ["ë°°ê°€ ê³ íŒŒì„œ", "ì‚¬ëŒì´ ì¡ì•„ì„œ", "ê±°ëŒ€í•œ ìš´ì„ ì¶©ëŒ", "ì ì„ ë„ˆë¬´ ë§ì´ ìì„œ"], answerIndex: 2 },
                { q: "ê³µë£¡ í™”ì„ì„ ì—°êµ¬í•˜ëŠ” ì‚¬ëŒì€ ëˆ„êµ¬ì¼ê¹Œìš”?", hint: "ê³ ê³ í•™ìë‚˜ OOOOí•™ì", options: ["ìš”ë¦¬ì‚¬", "ê³ ìƒë¬¼í•™ì", "ì˜ì‚¬", "ìš°ì£¼ë¹„í–‰ì‚¬"], answerIndex: 1 }
            ],
            // 6. ì§€êµ¬ ì»¤ì§ (ê³ êµ¬ë§ˆë¨¸ë¦¬) - ID: SUV_T-SW-uo
            "SUV_T-SW-uo": [
                { q: "ë§Œì•½ ì§€êµ¬ê°€ ì ì  ì»¤ì§€ë©´ ìš°ë¦¬ ëª¸ë¬´ê²ŒëŠ” ì–´ë–»ê²Œ ë ê¹Œìš”?", hint: "ì§€êµ¬ê°€ ë‹¹ê¸°ëŠ” í˜(ì¤‘ë ¥)ì´ ì„¸ì ¸ìš”.", options: ["ê°€ë²¼ì›Œì§„ë‹¤", "ì—„ì²­ ë¬´ê±°ì›Œì§„ë‹¤", "ë˜‘ê°™ë‹¤", "ë‘¥ë‘¥ ë– ë‹¤ë‹Œë‹¤"], answerIndex: 1 },
                { q: "ì§€êµ¬ê°€ ì»¤ì§€ë©´ í•˜ë£¨ì˜ ê¸¸ì´ëŠ” ì–´ë–»ê²Œ ë ê¹Œìš”?", hint: "ì§€êµ¬ê°€ í•œ ë°”í€´ ë„ëŠ” ë° ë” ì˜¤ë˜ ê±¸ë ¤ìš”.", options: ["24ì‹œê°„ë³´ë‹¤ ê¸¸ì–´ì§„ë‹¤", "ì§§ì•„ì§„ë‹¤", "1ì´ˆê°€ ëœë‹¤", "ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤"], answerIndex: 0 },
                { q: "ì´ ì˜ìƒì€ ë¬´ì—‡ì„ í•˜ê²Œ ë„ì™€ì¤„ê¹Œìš”?", hint: "ì •ë‹µì´ ì—†ëŠ” 'ë§Œì•½ì—' ë†€ì´!", options: ["ê³¼í•™ì  ìƒìƒë ¥ í‚¤ìš°ê¸°", "ë‹¬ë¦¬ê¸° ì—°ìŠµ", "ë…¸ë˜ ë¶€ë¥´ê¸°", "ì ìê¸°"], answerIndex: 0 }
            ],

            // 7. ê°œë¯¸ì™€ ë¹„ (ì‚¬ë¬¼ê¶ì´) - ID: _XulUbBra5M
            "_XulUbBra5M": [
                { q: "ë¹„ê°€ ì˜¤ë©´ ê°œë¯¸ë“¤ì€ êµ¬ë©ì„ ì–´ë–»ê²Œ í• ê¹Œìš”?", hint: "ë¬¼ì´ ë“¤ì–´ì˜¤ì§€ ëª»í•˜ê²Œ ë§‰ì•„ì•¼ í•´ìš”.", options: ["í™œì§ ì—´ì–´ë‘”ë‹¤", "í™ìœ¼ë¡œ ì…êµ¬ë¥¼ ë§‰ëŠ”ë‹¤", "ë¬¼ì„ ì±„ìš´ë‹¤", "ìˆ˜ì˜ì„ í•œë‹¤"], answerIndex: 1 },
                { q: "ê°œë¯¸ì§‘ì´ ë¬¼ì— ì‰½ê²Œ ì ê¸°ì§€ ì•ŠëŠ” ì´ìœ ëŠ”?", hint: "ê°œë¯¸ì§‘ì€ ê¼¬ë¶ˆê¼¬ë¶ˆí•˜ê³  ê³µê¸° ë°©ìš¸ì´ ìˆì–´ìš”.", options: ["ë°©ìˆ˜ í˜ì¸íŠ¸ë¥¼ ì¹ í•´ì„œ", "ê°œë¯¸ì§‘ êµ¬ì¡°ê°€ ê¼¬ë¶ˆê¼¬ë¶ˆí•´ì„œ", "ê°œë¯¸ê°€ ë¬¼ì„ ë§ˆì…”ì„œ", "ì§€ë¶•ì´ ìˆì–´ì„œ"], answerIndex: 1 },
                { q: "ì—¬ì™•ê°œë¯¸ì™€ ì•„ê¸° ê°œë¯¸ëŠ” ì–´ë””ë¡œ ëŒ€í”¼í• ê¹Œìš”?", hint: "ê°€ì¥ ê¹Šê³  ì•ˆì „í•œ ê³³!", options: ["ê°œë¯¸ì§‘ ë°–ìœ¼ë¡œ", "ê°€ì¥ ê¹Šì€ ë°©ìœ¼ë¡œ", "ë‚˜ë­‡ì ìœ„ë¡œ", "êµ¬ë¦„ ìœ„ë¡œ"], answerIndex: 1 }
            ],
            // 8. ë°”ë‚˜ë‚˜ ì”¨ (ê³¼í•™ë“œë¦¼) - ID: oA2PaUmv4ho
            "oA2PaUmv4ho": [
                { q: "ìš°ë¦¬ê°€ ë¨¹ëŠ” ë°”ë‚˜ë‚˜ì—ëŠ” ì™œ ì”¨ê°€ ì—†ì„ê¹Œìš”?", hint: "ì‚¬ëŒë“¤ì´ ë¨¹ê¸° í¸í•˜ê²Œ ì”¨ ì—†ëŠ” ê²ƒì„ ê³¨ë¼ í‚¤ì› ì–´ìš”.", options: ["ì›ë˜ ì—†ì—ˆë‹¤", "ì”¨ê°€ í‡´í™”í•´ì„œ ì—†ì–´ì¡Œë‹¤", "ì”¨ë¥¼ ë¹¼ê³  íŒ”ì•„ì„œ", "ë²Œë ˆê°€ ë¨¹ì–´ì„œ"], answerIndex: 1 },
                { q: "ë°”ë‚˜ë‚˜ëŠ” ì–´ë–»ê²Œ ìì†ì„ í¼ëœ¨ë¦´ê¹Œìš”?", hint: "ì”¨ì•— ëŒ€ì‹  ì´ê²ƒì„ ì‹¬ì–´ìš”.", options: ["ì”¨ì•— ì‹¬ê¸°", "ì¤„ê¸°(ë¿Œë¦¬)ë¥¼ ì˜ë¼ ì‹¬ê¸°", "ì—´ë§¤ ì‹¬ê¸°", "ê¸°ë„í•˜ê¸°"], answerIndex: 1 },
                { q: "ëª¨ë“  ë°”ë‚˜ë‚˜ê°€ ìœ ì „ì ìœ¼ë¡œ ë˜‘ê°™ìœ¼ë©´ ë¬´ì—‡ì´ ìœ„í—˜í• ê¹Œìš”?", hint: "í•œ ì¹œêµ¬ê°€ ê°ê¸°ì— ê±¸ë¦¬ë©´ ëª¨ë‘ ê±¸ë ¤ìš”.", options: ["ë§›ì´ ì—†ì–´ì§„ë‹¤", "ì „ì—¼ë³‘ì— ë‹¤ ê°™ì´ ê±¸ë¦´ ìˆ˜ ìˆë‹¤", "ë„ˆë¬´ ë§ì´ ì—´ë¦°ë‹¤", "ìƒ‰ê¹”ì´ ë³€í•œë‹¤"], answerIndex: 1 }
            ],
            // 9. í­ê·„ ë™ìƒ (ì€ê·¼í•œ ì¡ë‹¤í•œ ì§€ì‹) - ID: eA89rfDWGMs
            "eA89rfDWGMs": [
                { q: "í­ê·„ì´ ì–¼ìŒ ìœ„ì—ì„œë„ ë°œì´ ì–¼ì§€ ì•ŠëŠ” ë¹„ë°€ì€?", hint: "ë°œë°”ë‹¥ìœ¼ë¡œ ê°€ëŠ” í”¼ì˜ ì˜¨ë„ë¥¼ ì¡°ì ˆí•´ìš”(ì—´êµí™˜).", options: ["ì–‘ë§ì„ ì‹ ì–´ì„œ", "ë”°ëœ»í•œ í”¼ì™€ ì°¨ê°€ìš´ í”¼ê°€ ë§Œë‚˜ì„œ", "ë°œì´ ëœ¨ê±°ì›Œì„œ", "ì–¼ìŒì´ ë”°ëœ»í•´ì„œ"], answerIndex: 1 },
                { q: "í­ê·„ì˜ ëª¸ì„ ì¶”ìœ„ë¡œë¶€í„° ì§€ì¼œì£¼ëŠ” ê²ƒì€?", hint: "ëª¸ì†ì˜ OOOê³¼ ê²‰ì˜ OO", options: ["ë‘êº¼ìš´ ì§€ë°©ê³¼ ê¹ƒí„¸", "ì˜·", "ë‚œë¡œ", "ë•€"], answerIndex: 0 },
                { q: "í™©ì œí­ê·„ì€ ì–´ë””ì— ì‚´ê¹Œìš”?", hint: "ì§€êµ¬ì—ì„œ ê°€ì¥ ì¶”ìš´ ë‚¨ìª½ ë!", options: ["ë¶ê·¹", "ë‚¨ê·¹", "ë™ë¬¼ì›", "ì‚¬ë§‰"], answerIndex: 1 }
            ],

            // í˜¹ì‹œ ëª¨ë¥¼ ì—ëŸ¬ ë°©ì§€ìš© ê¸°ë³¸ í€´ì¦ˆ
            "DEFAULT": [
                { q: "ì˜ìƒì„ ì¬ë¯¸ìˆê²Œ ë³´ì•˜ë‚˜ìš”?", hint: "ì†”ì§í•˜ê²Œ ëŒ€ë‹µí•´ë´ìš”", options: ["ë„¤! ì¬ë¯¸ìˆì—ˆì–´ìš”", "ì¡°ê¸ˆ ì–´ë ¤ì› ì–´ìš”", "ë¬´ì„œì› ì–´ìš”", "ë‹¤ì‹œ ë³¼ë˜ìš”"], answerIndex: 0 },
                { q: "ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©ì„ ì—„ë§ˆ ì•„ë¹ ì—ê²Œ ì„¤ëª…í•´ì¤„ ìˆ˜ ìˆë‚˜ìš”?", hint: "ìì‹ ê° ìˆê²Œ!", options: ["ë„¤! í•  ìˆ˜ ìˆì–´ìš”", "ì•„ì§ ë¹„ë°€ì´ì—ìš”", "ì˜ ëª¨ë¥´ê² ì–´ìš”", "ë‚˜ì¤‘ì—ìš”"], answerIndex: 0 },
                { q: "ë‹¤ìŒì—ë„ iTubeë¡œ ê³¼í•™ ê³µë¶€ë¥¼ í• ê¹Œìš”?", hint: "ì•½ì†~", options: ["ë„¤! ë˜ í• ë˜ìš”", "ì•„ë‹ˆìš”", "ìƒê°í•´ë³¼ê²Œìš”", "ëª¨ë¥´ê² ì–´ìš”"], answerIndex: 0 }
            ]
        };

        let quizList = [];
        let quizIndex = 0;
        let correctCount = 0;
        let locked = false;

        function openQuiz() {
            if (ytPlayer && ytPlayer.stopVideo) ytPlayer.stopVideo();
            playerScreen.classList.add("hidden");
            quizScreen.classList.remove("hidden");
            document.body.classList.add("overflow-hidden");

            quizList = QUIZ_BANK[currentVideoId] || QUIZ_BANK["DEFAULT"];
            quizIndex = 0;
            correctCount = 0;

            quizTitle.textContent = `${currentTitle || "Video"} Â· Quiz`;
            renderQuestion();
        }

        function closeQuizToPlayer() {
            quizScreen.classList.add("hidden");
            playerScreen.classList.remove("hidden");
        }

        function resetFeedback() {
            quizFeedbackWrap.classList.add("hidden");
            quizFeedback.textContent = "";
            quizFeedback.className = "rounded-2xl p-4 text-sm font-bold";
            btnNextQuestion.classList.add("hidden");
            btnRetryQuiz.classList.add("hidden");
            btnQuizSuccess.classList.add("hidden");
        }

        function renderQuestion() {
            locked = false;
            resetFeedback();

            const total = quizList.length;
            const current = quizList[quizIndex];

            quizProgress.textContent = `ë¬¸ì œ ${quizIndex + 1}/${total}`;
            quizScore.textContent = `ì •ë‹µ ${correctCount}/${total}`;
            quizQuestion.textContent = current.q;
            quizHint.textContent = `íŒíŠ¸: ${current.hint || "ì˜ìƒì—ì„œ ë³¸ ë‚´ìš©ì„ ë– ì˜¬ë ¤ë³´ì„¸ìš” ğŸ™‚"}`;

            quizOptions.innerHTML = "";
            current.options.forEach((opt, idx) => {
                const btn = document.createElement("button");
                btn.type = "button";
                btn.className =
                    "w-full text-left px-5 py-4 rounded-2xl font-bold " +
                    "bg-slate-50 dark:bg-slate-700/60 border border-slate-200/70 dark:border-slate-600 " +
                    "hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors";
                btn.textContent = opt;
                btn.addEventListener("click", () => handleAnswer(idx));
                quizOptions.appendChild(btn);
            });
        }

        function handleAnswer(chosenIndex) {
            if (locked) return;
            locked = true;

            const current = quizList[quizIndex];
            const isCorrect = chosenIndex === current.answerIndex;
            const total = quizList.length;

            [...quizOptions.children].forEach((btnEl, idx) => {
                btnEl.disabled = true;
                btnEl.classList.add("opacity-90");
                if (idx === current.answerIndex) btnEl.classList.add("ring-2", "ring-green-400");
                if (idx === chosenIndex && !isCorrect) btnEl.classList.add("ring-2", "ring-red-400");
            });

            quizFeedbackWrap.classList.remove("hidden");

            if (isCorrect) {
                correctCount += 1;
                quizFeedback.textContent = "ì •ë‹µ! ğŸ‘";
                quizFeedback.classList.add("bg-green-500/10", "text-green-600", "border", "border-green-500/20");
            } else {
                quizFeedback.textContent = "ì•„ì‰½ë‹¤! ğŸ˜… ë‹¤ì‹œ ë– ì˜¬ë ¤ë³¼ê¹Œ?";
                quizFeedback.classList.add("bg-red-500/10", "text-red-600", "border", "border-red-500/20");
            }

            quizScore.textContent = `ì •ë‹µ ${correctCount}/${total}`;
            const isLast = quizIndex === total - 1;

            if (!isLast) {
                btnNextQuestion.classList.remove("hidden");
            } else {
                if (correctCount === total) {
                    btnQuizSuccess.classList.remove("hidden");
                    quizFeedback.textContent = "ğŸ‰ ë¯¸ì…˜ í†µê³¼! ì´ì œ ìœ íŠœë¸Œ ì¿ í°ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.";
                    quizFeedback.className = "rounded-2xl p-4 text-sm font-bold bg-green-500/10 text-green-700 border border-green-500/20";
                } else {
                    btnRetryQuiz.classList.remove("hidden");
                    quizFeedback.textContent = "í†µê³¼ ì‹¤íŒ¨ ğŸ˜… ë‹¤ì‹œ ë„ì „í•´ë³¼ê¹Œìš”?";
                    quizFeedback.className = "rounded-2xl p-4 text-sm font-bold bg-amber-500/10 text-amber-700 border border-amber-500/20";
                }
            }
        }

        btnNextQuestion.addEventListener("click", () => { quizIndex += 1; renderQuestion(); });
        btnRetryQuiz.addEventListener("click", openQuiz);
        btnQuizBack.addEventListener("click", closeQuizToPlayer);

        btnMission.addEventListener("click", () => {
            if (!currentVideoId) return;

            // âœ… ëê¹Œì§€ ì•ˆ ë³´ë©´ í€´ì¦ˆ ëª» ê°
            if (!canStartMission) {
                showAppModal({
                    title: "ì¡°ê¸ˆë§Œ ë”!",
                    message: "ì˜ìƒ ëê¹Œì§€ ë³´ê³  ë¯¸ì…˜ì„ ì‹œì‘í•  ìˆ˜ ìˆì–´ìš” ğŸ™‚",
                    okText: "í™•ì¸"
                });
                return;
            }

            openQuiz();
        });

        function getTodayKey() {
            const d = new Date();
            const y = d.getFullYear();
            const m = String(d.getMonth() + 1).padStart(2, "0");
            const day = String(d.getDate()).padStart(2, "0");
            return `${y}-${m}-${day}`;
        }


        // ===== Parent Setting (ëª¨ë“œ ì¶”ê°€ ë²„ì „) =====
        btnParentBack.addEventListener("click", () => parentScreen.classList.add("hidden"));

        // ê¸°ë³¸ê°’: ì•ˆì „ ëª¨ë“œ('kids')
        let setting = { count: 1, minutes: 20, remaining: 1, mode: 'kids' };

        function loadSetting() {
            const saved = localStorage.getItem("yt-setting");
            if (!saved) return;

            try {
                const s = JSON.parse(saved);
                const today = getTodayKey();

                // ë‚ ì§œê°€ ë°”ë€Œë©´ íšŸìˆ˜ ë¦¬ì…‹
                if (s.dateKey !== today) {
                    s.dateKey = today;
                    s.remaining = s.count;
                    localStorage.setItem("yt-setting", JSON.stringify(s));
                }

                // ëª¨ë“œ ì„¤ì •ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ 'kids' ì¶”ê°€
                if (!s.mode) s.mode = 'kids';

                setting = s;
            } catch (e) { }
        }

        loadSetting();

        // ê¸°ì¡´ renderTimeOptions í•¨ìˆ˜ë¥¼ ì°¾ì•„ì„œ ì´ê±¸ë¡œ ë®ì–´ì”Œìš°ì„¸ìš”.
        function renderTimeOptions(count) {
            timeOptions.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ë¹„ìš°ê¸°
            let options = [];

            // âœ… ë‹˜ ì½”ë“œì— ìˆë˜ ë¡œì§ ê·¸ëŒ€ë¡œ ìœ ì§€
            if (count === 1) options = [20, 30, 40];
            if (count === 2) options = [20, 25];

            options.forEach(min => {
                // <label class="radio-box"> ìƒì„±
                const label = document.createElement("label");
                label.className = "radio-box";

                // ë‚´ë¶€ HTML: inputê³¼ ì˜ˆìœ span
                label.innerHTML = `
            <input type="radio" name="timePerView" value="${min}">
            <span class="radio-label">${min}ë¶„</span>
        `;

                // í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
                const input = label.querySelector("input");
                input.addEventListener("change", () => { setting.minutes = min; });

                // í™”ë©´ì— ì¶”ê°€
                timeOptions.appendChild(label);
            });
        }

        function restoreParentSettingUI() {
            // 1. íšŸìˆ˜ ë³µì›
            document.querySelectorAll('input[name="viewCount"]').forEach(radio => {
                radio.checked = Number(radio.value) === setting.count;
            });
            renderTimeOptions(setting.count);

            // 2. ì‹œê°„ ë³µì›
            document.querySelectorAll('input[name="timePerView"]').forEach(radio => {
                radio.checked = Number(radio.value) === setting.minutes;
            });

            // 3. [ì¶”ê°€] ëª¨ë“œ ë³µì›
            document.querySelectorAll('input[name="ytMode"]').forEach(radio => {
                radio.checked = radio.value === (setting.mode || 'kids');
            });
        }

        function updateTodaySummary() {
            const summary = document.getElementById("todaySummary");
            if (!summary) return;

            const modeName = (setting.mode === 'general') ? "ğŸ—½ììœ ëª¨ë“œ" : "ğŸ›¡ï¸ì•ˆì „ëª¨ë“œ";
            summary.textContent = `ì˜¤ëŠ˜ ì„¤ì •: ${setting.count}íšŒ (${setting.minutes}ë¶„ì”©) Â· ${modeName} Â· ë‚¨ì€ ${setting.remaining}íšŒ`;
        }

        // íšŸìˆ˜ ë³€ê²½ ì‹œ ì‹œê°„ ì˜µì…˜ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
        document.querySelectorAll('input[name="viewCount"]').forEach(radio => {
            radio.addEventListener("change", () => {
                const count = Number(radio.value);
                setting.count = count;
                renderTimeOptions(count);
                // ì‹œê°„ ì„ íƒì´ í’€ë¦¬ë¯€ë¡œ ê¸°ë³¸ê°’ ì¬ì„¤ì •
                setting.minutes = (count === 1) ? 20 : 20;
                restoreParentSettingUI();
            });
        });

        // ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ
        btnSaveSetting.addEventListener("click", async () => {
            if (!setting.minutes) setting.minutes = 20;

            // ëª¨ë“œ ê°’ ì½ì–´ì˜¤ê¸°
            const selectedMode = document.querySelector('input[name="ytMode"]:checked');
            if (selectedMode) setting.mode = selectedMode.value;

            setting.dateKey = getTodayKey();
            setting.remaining = setting.count; // ì €ì¥í•˜ë©´ íšŸìˆ˜ ë¦¬ì…‹

            localStorage.setItem("yt-setting", JSON.stringify(setting));
            restoreParentSettingUI();
            updateTodaySummary();
            await showAppModal({ title: "ì €ì¥ ì™„ë£Œ", message: "ì˜¤ëŠ˜ì˜ ìœ íŠœë¸Œ ê·œì¹™ì´ ì €ì¥ëì–´ìš”!", okText: "í™•ì¸" });
            parentScreen.classList.add("hidden");
        });

        // ===== PIN Modal =====
        const pinModal = document.getElementById("pinModal");
        const pinTitle = document.getElementById("pinTitle");
        const pinDots = pinModal.querySelectorAll(".pin-dot");
        const pinKeys = pinModal.querySelectorAll(".pin-key");
        const pinBack = document.getElementById("pinBack");
        const pinCancel = document.getElementById("pinCancel");
        const pinError = document.getElementById("pinError");

        const PIN_KEY = "yt-parent-pin";
        const DEFAULT_PIN = "1111";

        let pinInput = "";
        let pinResolve = null;
        let pinMode = "verify";

        function getParentPin() {
            const saved = localStorage.getItem(PIN_KEY);
            if (saved && saved.trim()) return saved.trim();
            localStorage.setItem(PIN_KEY, DEFAULT_PIN);
            return DEFAULT_PIN;
        }

        function updatePinDots() {
            pinDots.forEach((dot, i) => dot.classList.toggle("filled", i < pinInput.length));
        }

        function openPinVerifyModal(title = "ğŸ”’ ë¶€ëª¨ PIN ì…ë ¥") {
            pinMode = "verify";
            pinInput = "";
            pinError.classList.add("hidden");
            updatePinDots();
            pinTitle.textContent = title;
            pinModal.classList.remove("hidden");
            return new Promise(resolve => { pinResolve = resolve; });
        }

        function openPinSetModal(title = "ğŸ”¢ ìƒˆ PIN ì…ë ¥") {
            pinMode = "set";
            pinInput = "";
            pinError.classList.add("hidden");
            updatePinDots();
            pinTitle.textContent = title;
            pinModal.classList.remove("hidden");
            return new Promise(resolve => { pinResolve = resolve; });
        }

        function closePinModal(result) {
            pinModal.classList.add("hidden");
            if (pinResolve) pinResolve(result);
            pinResolve = null;
        }

        function handlePinComplete() {
            if (pinMode === "verify") {
                if (pinInput === getParentPin()) closePinModal(true);
                else {
                    pinError.textContent = "PINì´ í‹€ë ¸ì–´ìš”";
                    pinError.classList.remove("hidden");
                    pinInput = "";
                    updatePinDots();
                }
                return;
            }
            closePinModal(pinInput);
        }

        pinKeys.forEach(btn => {
            btn.addEventListener("click", () => {
                if (pinInput.length >= 4) return;
                pinInput += btn.textContent.trim();
                updatePinDots();
                if (pinInput.length === 4) handlePinComplete();
            });
        });

        pinBack.addEventListener("click", () => { pinInput = pinInput.slice(0, -1); updatePinDots(); });
        pinCancel.addEventListener("click", () => closePinModal(pinMode === "verify" ? false : null));

        btnChangePin.addEventListener("click", async () => {
            const ok = await openPinVerifyModal("ğŸ”’ í˜„ì¬ PIN ì…ë ¥");
            if (!ok) return;

            const newPin = await openPinSetModal("ğŸ”¢ ìƒˆ PIN ì…ë ¥(4ìë¦¬)");
            if (newPin === null) return;
            if (!/^\d{4}$/.test(newPin)) {
                await showAppModal({ title: "ì˜¤ë¥˜", message: "PINì€ 4ìë¦¬ ìˆ«ìì—¬ì•¼ í•´ìš”.", okText: "í™•ì¸" });
                return;
            }

            const confirmPin = await openPinSetModal("âœ… ìƒˆ PIN í•œ ë²ˆ ë” ì…ë ¥");
            if (confirmPin === null) return;
            if (confirmPin !== newPin) {
                await showAppModal({ title: "ì˜¤ë¥˜", message: "PINì´ ì¼ì¹˜í•˜ì§€ ì•Šì•„ìš”.", okText: "í™•ì¸" });
                return;
            }

            localStorage.setItem(PIN_KEY, newPin);
            await showAppModal({ title: "ì™„ë£Œ", message: "ë¶€ëª¨ PINì´ ë³€ê²½ëì–´ìš”!", okText: "í™•ì¸" });
        });

        btnParent.addEventListener("click", async () => {
            const ok = await openPinVerifyModal("ğŸ”’ ë¶€ëª¨ PIN ì…ë ¥");
            if (!ok) return;
            loadSetting();
            restoreParentSettingUI();
            updateTodaySummary();
            parentScreen.classList.remove("hidden");
        });

        // ===== Coupon + Timer Flow =====
        btnQuizSuccess.addEventListener("click", async () => {
            loadSetting();
            if (setting.remaining <= 0) {
                await showAppModal({ title: "ì˜¤ëŠ˜ ì¿ í° ë!", message: "ì˜¤ëŠ˜ì€ ìœ íŠœë¸Œ ì¿ í°ì„ ë‹¤ ì‚¬ìš©í–ˆì–´ìš”.", okText: "í™•ì¸" });
                return;
            }
            quizScreen.classList.add("hidden");
            await openCoupon();
        });

        // ===== Coupon Flow (ëª¨ë“œë³„ ë©”ì‹œì§€ & ë§í¬ ë¶„ê¸°) =====
        // ===== [ìˆ˜ì •ë¨] ì•½ì† ëª¨ë‹¬ ê´€ë ¨ ë¡œì§ =====
        const promiseModal = document.getElementById("promiseModal");
        const promiseChecks = document.querySelectorAll(".promise-check");
        const btnPromiseStart = document.getElementById("btnPromiseStart");

        // ê¸°ì¡´ openCoupon í•¨ìˆ˜ë¥¼ ì´ê±¸ë¡œ êµì²´í•˜ì„¸ìš”!
        async function openCoupon() {
            // 1. ëª¨ë“œ í™•ì¸
            let mode = setting.mode || 'kids';

            // ì•ˆì „ëª¨ë“œ(í‚¤ì¦ˆ)ì¼ ë•ŒëŠ” êµ³ì´ ì‚´ë²Œí•˜ê²Œ ì•½ì† ì•ˆ ë°›ì•„ë„ ë˜ë‹ˆ ë°”ë¡œ ì‹œì‘ (ì„ íƒ ì‚¬í•­)
            // ë§Œì•½ ì•ˆì „ëª¨ë“œì—ì„œë„ ì•½ì†ë°›ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ ifë¬¸ì„ ì§€ìš°ì„¸ìš”.
            /*
            if (mode === 'kids') {
                const ok = await showAppModal({
                    title: "ğŸ›¡ï¸ ìœ íŠœë¸Œ í‚¤ì¦ˆ ì´ìš©ê¶Œ",
                    message: `ì¶•í•˜í•´ìš”! ${setting.minutes}ë¶„ ë™ì•ˆ ë³¼ ìˆ˜ ìˆì–´ìš”.\nì¤€ë¹„ëë‚˜ìš”?`,
                    okText: "ë„¤! ì¶œë°œ~",
                    cancelText: "ë‚˜ì¤‘ì—"
                });
                if(ok) startYoutubeSession();
                return;
            }
            */

            // 2. ì•½ì† ëª¨ë‹¬ ì—´ê¸° (ììœ ëª¨ë“œ ë“±)
            openPromiseModal();
        }

        function openPromiseModal() {
            // 1. ì‹œê°„ê³¼ íšŸìˆ˜ ì •ë³´ ì—…ë°ì´íŠ¸ (ìƒˆë¡œ ì¶”ê°€ë¨!)
            const infoText = document.getElementById("promiseInfoText");
            if (infoText) {
                // "20ë¶„" ë¶€ë¶„ì€ í¬ê²Œ, "ë‚¨ì€ ê¸°íšŒ"ëŠ” ì‘ê²Œ í‘œì‹œ
                infoText.innerHTML = `
                    ğŸ‰ ì™€! <span class="text-2xl text-orange-600">${setting.minutes}ë¶„</span> ë™ì•ˆ ë³¼ ìˆ˜ ìˆì–´ìš”.<br>
                    <span class="text-xs text-slate-400 font-normal">(ì˜¤ëŠ˜ ë‚¨ì€ ê¸°íšŒ: ${setting.remaining}ë²ˆ)</span>
                `;
            }

            // 2. ì´ˆê¸°í™”: ì²´í¬ë°•ìŠ¤ ë‹¤ í’€ê³  ë²„íŠ¼ ë¹„í™œì„±í™” (ê¸°ì¡´ ì½”ë“œ)
            promiseChecks.forEach(chk => chk.checked = false);
            updatePromiseButton();

            promiseModal.classList.remove("hidden");
        }

        function closePromiseModal() {
            promiseModal.classList.add("hidden");
        }

        // ì²´í¬ë°•ìŠ¤ ëˆ„ë¥¼ ë•Œë§ˆë‹¤ ê²€ì‚¬
        promiseChecks.forEach(chk => {
            chk.addEventListener("change", updatePromiseButton);
        });

        function updatePromiseButton() {
            // ì²´í¬ëœ ê°œìˆ˜ ì„¸ê¸°
            const checkedCount = document.querySelectorAll(".promise-check:checked").length;
            const total = promiseChecks.length;

            if (checkedCount === total) {
                // ë‹¤ ì²´í¬í–ˆìœ¼ë©´ ë²„íŠ¼ í™œì„±í™” (ì´ˆë¡ìƒ‰)
                btnPromiseStart.disabled = false;
                btnPromiseStart.classList.remove("bg-slate-300", "cursor-not-allowed", "shadow-none");
                btnPromiseStart.classList.add("bg-primary", "shadow-glow", "hover:opacity-90");
                btnPromiseStart.textContent = "ì•½ì† ì§€í‚¬ê²Œìš”! ì¶œë°œ! ğŸš€";
            } else {
                // í•˜ë‚˜ë¼ë„ ë¶€ì¡±í•˜ë©´ ë¹„í™œì„±í™” (íšŒìƒ‰)
                btnPromiseStart.disabled = true;
                btnPromiseStart.classList.add("bg-slate-300", "cursor-not-allowed", "shadow-none");
                btnPromiseStart.classList.remove("bg-primary", "shadow-glow", "hover:opacity-90");
                btnPromiseStart.textContent = `ì•½ì† ì§€í‚¬ê²Œìš”! (${checkedCount}/${total})`;
            }
        }

        // "ì•½ì† ì§€í‚¬ê²Œìš”" ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
        btnPromiseStart.addEventListener("click", () => {
            closePromiseModal();
            startYoutubeSession();
        });

        // ê³µí†µ ì‹œì‘ ë¡œì§ ë¶„ë¦¬
        function startYoutubeSession() {
            setting.remaining -= 1;
            localStorage.setItem("yt-setting", JSON.stringify(setting));
            updateTodaySummary();
            openTimerScreenReady(setting.minutes);
        }


        let timerIntervalId = null;
        let timerEndsAt = 0;
        let timerTotalSec = 0;
        let timerStarted = false;
        let oneMinuteWarned = false; // ğŸ‘ˆ [ì¶”ê°€] 1ë¶„ ì•Œë¦¼ ìš¸ë ¸ëŠ”ì§€ ì²´í¬í•˜ëŠ” ë³€ìˆ˜

        // âœ… 1) íƒ€ì´ë¨¸ í™”ë©´ì€ ì—´ë˜, ì•„ì§ ì‹œì‘í•˜ì§€ ì•ŠëŠ” "ì¤€ë¹„" ìƒíƒœ
        function openTimerScreenReady(totalMinutes) {
            timerStarted = false;
            timerEndBox.classList.add("hidden");

            timerTotalSec = totalMinutes * 60;
            timerEndsAt = 0; // ì•„ì§ ë¯¸ì •

            // UIë§Œ "ì¤€ë¹„ ìƒíƒœ"ë¡œ
            timerText.textContent = formatMMSS(timerTotalSec);
            timerBar.style.width = "0%";
            timerStartText.textContent = "ëŒ€ê¸°";
            timerEndText.textContent = `${totalMinutes}ë¶„`;

            // íƒ€ì´ë¨¸ í™”ë©´ ì—´ê¸°
            timerScreen.classList.remove("hidden");
            document.body.classList.add("overflow-hidden");

            // í˜¹ì‹œ ë‚¨ì•„ìˆë˜ interval ì •ë¦¬
            if (timerIntervalId) {
                clearInterval(timerIntervalId);
                timerIntervalId = null;
            }

            // âœ… yt-timer ì €ì¥ë„ ì•„ì§ í•˜ì§€ ì•ŠìŒ (ì‹œì‘ ë²„íŠ¼ ëˆ„ë¥¼ ë•Œ ì €ì¥)
            localStorage.removeItem("yt-timer");
        }

        // âœ… 2) ì‹¤ì œ ì‹œì‘(ìœ íŠœë¸Œ ì´ë™ ë²„íŠ¼ í´ë¦­ ìˆœê°„ ì‹¤í–‰)
        function startTimerNow() {
            if (timerStarted) return;
            timerStarted = true;
            oneMinuteWarned = false; // ğŸ‘ˆ [ì¶”ê°€] íƒ€ì´ë¨¸ ì‹œì‘í•  ë•Œ ì•Œë¦¼ ìƒíƒœ ì´ˆê¸°í™”!

            timerEndsAt = Date.now() + timerTotalSec * 1000;

            // ì €ì¥ ì‹œì‘
            localStorage.setItem("yt-timer", JSON.stringify({
                endsAt: timerEndsAt,
                totalSec: timerTotalSec,
                running: true
            }));

            timerStartText.textContent = "ì§€ê¸ˆ";
            timerEndText.textContent = "ì§„í–‰ ì¤‘";

            updateTimerUI();
            timerIntervalId = setInterval(updateTimerUI, 250);
        }


        btnTimerClose.addEventListener("click", closeTimerScreen);

        function closeTimerScreen() {
            timerScreen.classList.add("hidden");
            homeScreen.classList.remove("hidden");
            document.body.classList.remove("overflow-hidden");
        }

        function formatMMSS(sec) {
            const m = Math.floor(sec / 60);
            const s = sec % 60;
            return `${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;
        }

        function updateTimerUI() {
            const remainingMs = timerEndsAt - Date.now();
            const remainingSec = Math.max(0, Math.ceil(remainingMs / 1000));

            timerText.textContent = formatMMSS(remainingSec);

            const elapsed = timerTotalSec - remainingSec;
            const pct = timerTotalSec > 0 ? (elapsed / timerTotalSec) * 100 : 0;
            timerBar.style.width = `${Math.min(100, Math.max(0, pct))}%`;

            // ğŸ‘‡ [ì—¬ê¸°ë¶€í„° ì¶”ê°€] 1ë¶„(60ì´ˆ) ë‚¨ì•˜ì„ ë•Œ ì•Œë¦¼ ìš¸ë¦¬ê¸°!
            if (remainingSec <= 60 && remainingSec > 0 && !oneMinuteWarned) {
                oneMinuteWarned = true; // í•œ ë²ˆë§Œ ìš¸ë¦¬ê²Œ ì ê¸ˆ
                playWarningSound();     // ì†Œë¦¬ ì¬ìƒ!

                // (ì„ íƒ) í™”ë©´ì—ë„ ë©”ì‹œì§€ ë„ìš°ê¸°
                showAppModal({
                    title: "â° 1ë¶„ ë‚¨ì•˜ì–´ìš”!",
                    message: "ì´ì œ ê³§ ëë‚  ì‹œê°„ì´ì—ìš”. ìŠ¬ìŠ¬ ë§ˆë¬´ë¦¬í•´ë³¼ê¹Œìš”?",
                    okText: "ë„¤, ì•Œê² ì–´ìš”!"
                });
            }
            // ğŸ‘† [ì—¬ê¸°ê¹Œì§€ ì¶”ê°€]

            if (remainingSec <= 0) onTimerEnd();
        }

        function onTimerEnd() {
            if (timerIntervalId) { clearInterval(timerIntervalId); timerIntervalId = null; }
            timerBar.style.width = "100%";
            timerEndBox.classList.remove("hidden");
            localStorage.removeItem("yt-timer");
        }

        // íƒ€ì´ë¨¸ ì¬ê°œ(ë¦¬ë¡œë“œ)
        (function restoreTimerOnLoad() {
            const saved = localStorage.getItem("yt-timer");
            if (!saved) return;

            try {
                const data = JSON.parse(saved);
                if (!data.running) return;

                const remainingMs = data.endsAt - Date.now();
                if (remainingMs <= 0) {
                    localStorage.removeItem("yt-timer");
                    return;
                }

                timerTotalSec = data.totalSec;
                timerEndsAt = data.endsAt;

                timerStarted = true;

                timerEndBox.classList.add("hidden");
                timerStartText.textContent = "ì§€ê¸ˆ";
                timerEndText.textContent = "ì§„í–‰ ì¤‘";

                timerScreen.classList.remove("hidden");
                document.body.classList.add("overflow-hidden");

                if (timerIntervalId) clearInterval(timerIntervalId);
                updateTimerUI();
                timerIntervalId = setInterval(updateTimerUI, 250);
            } catch (e) {
                localStorage.removeItem("yt-timer");
            }
        })();

        // ìœ íŠœë¸Œ ì—´ê¸° ë²„íŠ¼: ëª¨ë“œì— ë”°ë¼ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì´ë™!
        btnOpenYouTube.addEventListener("click", () => {
            startTimerNow();

            const mode = setting.mode || 'kids';
            let url = "https://www.youtubekids.com"; // ê¸°ë³¸: í‚¤ì¦ˆ

            if (mode === 'general') {
                url = "https://www.youtube.com"; // ììœ  ëª¨ë“œ: ì¼ë°˜ ìœ íŠœë¸Œ
            }

            window.open(url, "_blank");
        });


        // ì§€ê¸ˆ ì¢…ë£Œ(ë¶€ëª¨ PIN)
        btnTimerEndNow.addEventListener("click", async () => {
            const ok = await openPinVerifyModal("ğŸ”’ ë¶€ëª¨ PIN ì…ë ¥");
            if (!ok) return;

            if (timerIntervalId) { clearInterval(timerIntervalId); timerIntervalId = null; }
            timerEndsAt = Date.now();
            updateTimerUI();
            localStorage.removeItem("yt-timer");
            closeTimerScreen();
        });

        // í€´ì¦ˆ/í”Œë ˆì´ì–´/ESC
        window.addEventListener("keydown", (e) => {
            if (e.key !== "Escape") return;
            if (!quizScreen.classList.contains("hidden")) { closeQuizToPlayer(); return; }
            if (!playerScreen.classList.contains("hidden")) closePlayer();

        });
        // ===== ë¡œê³  í´ë¦­ ì‹œ í™ˆìœ¼ë¡œ ì´ë™ =====
        btnHomeLogo.addEventListener("click", async () => {
            // 1. ë§Œì•½ íƒ€ì´ë¨¸ê°€ ëŒê³  ìˆë‹¤ë©´(ìœ íŠœë¸Œ ì‹œì²­ ì¤‘), ê·¸ëƒ¥ ë‚˜ê°€ë©´ ì•ˆ ë˜ë‹ˆê¹Œ ë¬¼ì–´ë³´ê¸°
            if (!timerScreen.classList.contains("hidden")) {
                // íƒ€ì´ë¨¸ í™”ë©´ì—ì„œëŠ” ë¡œê³  í´ë¦­ì„ ë§‰ê±°ë‚˜, ê²½ê³ ë¥¼ ë„ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                // ì§€ê¸ˆì€ ê°„ë‹¨í•˜ê²Œ 'ì•„ë¬´ ë™ì‘ ì•ˆ í•¨'ìœ¼ë¡œ ë‘ê±°ë‚˜, 
                // ë¶€ëª¨ í•€ì„ ì…ë ¥í•´ì•¼ ë‚˜ê°ˆ ìˆ˜ ìˆê²Œ í•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤.
                return;
            }

            // 2. ë‹¤ë¥¸ í™”ë©´ë“¤ ì‹¹ ë‹¤ ë‹«ê¸°
            playerScreen.classList.add("hidden");
            quizScreen.classList.add("hidden");
            parentScreen.classList.add("hidden");

            // 3. í™ˆ í™”ë©´ ì—´ê¸°
            homeScreen.classList.remove("hidden");
            document.body.classList.remove("overflow-hidden");

            // 4. ì˜ìƒì´ ì¬ìƒ ì¤‘ì´ì—ˆë‹¤ë©´ ë„ê¸°
            if (ytPlayer && ytPlayer.stopVideo) {
                ytPlayer.stopVideo();
            }

            // 5. ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤ ë§¨ ìœ„ë¡œ
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // ===== ğŸ”Š 1ë¶„ ì•Œë¦¼ ì‚¬ìš´ë“œ í•¨ìˆ˜ (ë”©ë™ + ëª©ì†Œë¦¬) =====
        // ===== [ìˆ˜ì •ë¨] 1ë¶„ ì•Œë¦¼ ì‚¬ìš´ë“œ (ìœ íŠœë¸Œ ì†Œë¦¬ ì¤„ì´ê¸° ê¸°ëŠ¥ ì¶”ê°€) =====
        function playWarningSound() {
            // 1. ìœ íŠœë¸Œ ì†Œë¦¬ ì ê¹ ì¤„ì´ê¸° (í•µì‹¬!)
            let originalVolume = 100; // ê¸°ë³¸ê°’
            if (ytPlayer && ytPlayer.getVolume) {
                originalVolume = ytPlayer.getVolume(); // í˜„ì¬ ë³¼ë¥¨ ê¸°ì–µí•˜ê¸°
                ytPlayer.setVolume(10); // ì†Œë¦¬ë¥¼ 10ìœ¼ë¡œ ì•„ì£¼ ì‘ê²Œ ì¤„ì„
            }

            // 2. ë”©ë™~ ì†Œë¦¬ í¬ê²Œ ì¬ìƒ (Web Audio API)
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const now = ctx.currentTime;

                // ì†Œë¦¬ í¬ê¸° ì¦í­ (Gain)
                const masterGain = ctx.createGain();
                masterGain.connect(ctx.destination);
                masterGain.gain.value = 1.0; // 0.3ì—ì„œ 1.0ìœ¼ë¡œ ìµœëŒ€ ë³¼ë¥¨ ì„¤ì •!

                // ë„ (C5)
                const osc1 = ctx.createOscillator();
                const gain1 = ctx.createGain();
                osc1.connect(gain1);
                gain1.connect(masterGain); // ë§ˆìŠ¤í„° ë³¼ë¥¨ì— ì—°ê²°
                osc1.frequency.setValueAtTime(523.25, now);
                gain1.gain.setValueAtTime(0.5, now); // ê°œë³„ ìŒëŸ‰ë„ ì¡°ê¸ˆ í‚¤ì›€
                gain1.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
                osc1.start(now);
                osc1.stop(now + 0.5);

                // ë¯¸ (E5)
                const osc2 = ctx.createOscillator();
                const gain2 = ctx.createGain();
                osc2.connect(gain2);
                gain2.connect(masterGain);
                osc2.frequency.setValueAtTime(659.25, now + 0.2);
                gain2.gain.setValueAtTime(0.5, now + 0.2);
                gain2.gain.exponentialRampToValueAtTime(0.01, now + 0.7);
                osc2.start(now + 0.2);
                osc2.stop(now + 0.7);
            } catch (e) { console.error("Audio Error:", e); }

            // 3. ì¹œì ˆí•œ ëª©ì†Œë¦¬ ì•ˆë‚´ (TTS)
            if ('speechSynthesis' in window) {
                const msg = new SpeechSynthesisUtterance("ì´ì œ 1ë¶„ ë‚¨ì•˜ì–´ìš”. ìœ íŠœë¸Œ ëŒ ì¤€ë¹„ í•´ì£¼ì„¸ìš”");
                msg.lang = 'ko-KR';
                msg.volume = 1.0;   // ëª©ì†Œë¦¬ ë³¼ë¥¨ ìµœëŒ€
                msg.rate = 0.9;     // ì•„ì´ë“¤ì´ ì˜ ë“£ê²Œ ì•½ê°„ ì²œì²œíˆ
                msg.pitch = 1.2;    // ë°ì€ í†¤
                window.speechSynthesis.speak(msg);
            }

            // 4. 5ì´ˆ ë’¤ì— ìœ íŠœë¸Œ ì†Œë¦¬ ì›ìƒë³µêµ¬
            setTimeout(() => {
                if (ytPlayer && ytPlayer.setVolume) {
                    ytPlayer.setVolume(originalVolume); // ì•„ê¹Œ ê¸°ì–µí•´ë‘” ë³¼ë¥¨ìœ¼ë¡œ ë³µê·€
                }
            }, 5000); // 5ì´ˆ ë™ì•ˆì€ ì¡°ìš©íˆ
        }

        // [ì¶”ê°€í•  ìœ„ì¹˜: script ë§¨ ì•„ë˜]

        // ===== í”„ë¡œí•„ ë³€ê²½ ê¸°ëŠ¥ =====
        const profileModal = document.getElementById('profileModal');
        const currentProfileImg = document.getElementById('currentProfileImg');
        const PROFILE_KEY = 'itube_profile_img'; // ì €ì¥ì†Œ í‚¤ ì´ë¦„

        // 1. ì €ì¥ëœ í”„ë¡œí•„ ë¶ˆëŸ¬ì˜¤ê¸° (í˜ì´ì§€ ì—´ë¦´ ë•Œ ì‹¤í–‰)
        function loadProfile() {
            const savedUrl = localStorage.getItem(PROFILE_KEY);
            if (savedUrl && currentProfileImg) {
                currentProfileImg.src = savedUrl;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì‹¤í–‰
        loadProfile();

        // 2. ëª¨ë‹¬ ì—´ê¸°
        function openProfileModal() {
            profileModal.classList.remove('hidden');
        }

        // 3. ëª¨ë‹¬ ë‹«ê¸°
        function closeProfileModal() {
            profileModal.classList.add('hidden');
        }

        // 4. í”„ë¡œí•„ ë³€ê²½í•˜ê³  ì €ì¥í•˜ê¸°
        function changeProfile(url) {
            // ì´ë¯¸ì§€ ë°”ê¾¸ê¸°
            if (currentProfileImg) currentProfileImg.src = url;

            // ì €ì¥í•˜ê¸° (ìƒˆë¡œê³ ì¹¨ í•´ë„ ìœ ì§€ë¨)
            localStorage.setItem(PROFILE_KEY, url);

            // ëª¨ë‹¬ ë‹«ê¸°
            closeProfileModal();

            // (ì„ íƒ) ì•Œë¦¼ ë„ìš°ê¸° - í•„ìš” ì—†ìœ¼ë©´ ì‚­ì œ ê°€ëŠ¥
            // showAppModal({ title: "ë³€ê²½ ì™„ë£Œ", message: "ìƒˆë¡œìš´ ì¹œêµ¬ì™€ í•¨ê»˜ ë†€ì•„ìš”!", okText: "ì¢‹ì•„ìš”" });
        }

        // ëª¨ë‹¬ ë°”ê¹¥ ë°°ê²½ ëˆ„ë¥´ë©´ ë‹«ê¸°
        profileModal.addEventListener('click', (e) => {
            if (e.target === profileModal) closeProfileModal();
        });

    </script>
</body>

</html>
